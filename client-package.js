!function(e,t){!function(e,t){"use strict";t.NestedModel=t.Model.extend({isNestedModel:!0,get:function(e){return t.NestedModel.walkThenGet(this.attributes,e)},previous:function(e){return t.NestedModel.walkThenGet(this._previousAttributes,e)},has:function(t){var a=this.get(t);return!(null===a||e.isUndefined(a))},set:function(a,n,i){var r,o,s,l=t.NestedModel.deepClone(this.attributes),d=[];if(e.isString(a)?r=t.NestedModel.attrPath(a):e.isArray(a)&&(r=a),r)i=i||{},this._setAttr(l,r,n,i),d.push(r[0]);else{i=n||{};var c=a;for(var u in c)if(c.hasOwnProperty(u)){var h=t.NestedModel.attrPath(u);this._setAttr(l,h,i.unset?void 0:c[u],i),d.push(h[0])}}return this._nestedChanges=t.NestedModel.__super__.changedAttributes.call(this),i.unset&&r&&1===r.length?((o={})[a]=void 0,this._nestedChanges=e.omit(this._nestedChanges,e.keys(o)),s=t.NestedModel.__super__.set.call(this,e.pick(o,d),i)):(o=l,i.unset&&r?delete(i=e.extend({},i)).unset:i.unset&&e.isObject(a)&&(o=a),this._nestedChanges=e.omit(this._nestedChanges,e.keys(o)),s=t.NestedModel.__super__.set.call(this,e.pick(o,d),i)),s?(this._runDelayedTriggers(),this):(this.changed={},this._nestedChanges={},!1)},unset:function(t,a){return this.set(t,void 0,e.extend({},a,{unset:!0}))},clear:function(t){this._nestedChanges={},t=t||{};var a=e.clone(this.attributes);if(!t.silent&&this.validate&&!this.validate(a,t))return!1;var n=this.changed={},i=this,r=function(t,a,o){e.each(t,function(s,l){var d=a;e.isArray(t)?d+="["+l+"]":a?d+="."+l:d=l,s=t[l],e.isObject(s)&&r(s,d,o),o.silent||i._delayedChange(d,null,o),n[d]=null})};return r(this.attributes,"",t),this.attributes={},t.silent||this._delayedTrigger("change"),this._runDelayedTriggers(),this},add:function(t,a,n){var i=this.get(t);if(!e.isArray(i))throw new Error("current value is not an array");return this.set(t+"["+i.length+"]",a,n)},remove:function(a,n){n=n||{};var i=t.NestedModel.attrPath(a),r=e.initial(i),o=this.get(r),s=e.last(i);if(!e.isArray(o))throw new Error("remove() must be called on a nested array");var l=!n.silent&&o.length>=s+1,d=o[s];if(o.splice(s,1),n.silent=!0,this.set(r,o,n),l){a=t.NestedModel.createAttrStr(r),this.trigger("remove:"+a,this,d);for(var c=r.length;c>=1;c--)a=t.NestedModel.createAttrStr(e.first(r,c)),this.trigger("change:"+a,this,d);this.trigger("change",this,d)}return this},changedAttributes:function(a){var n=t.NestedModel.__super__.changedAttributes.call(this,a);return!!e.isObject(n)&&e.extend({},this._nestedChanges,n)},toJSON:function(){return t.NestedModel.deepClone(this.attributes)},_getDelayedTriggers:function(){return void 0===this._delayedTriggers&&(this._delayedTriggers=[]),this._delayedTriggers},_delayedTrigger:function(){this._getDelayedTriggers().push(arguments)},_delayedChange:function(e,t,a){this._delayedTrigger("change:"+e,this,t,a),this.changed||(this.changed={}),this.changed[e]=t},_runDelayedTriggers:function(){for(;this._getDelayedTriggers().length>0;)this.trigger.apply(this,this._getDelayedTriggers().shift())},_setAttr:function(a,n,i,r){r=r||{};var o=n.length,s=this;t.NestedModel.walkPath(a,n,function(a,l,d){var c=e.last(l),u=t.NestedModel.createAttrStr(l),h=!e.isEqual(a[c],i);if(l.length===o){if(r.unset){if(delete a[c],e.isArray(a)){var p=t.NestedModel.createAttrStr(e.initial(n));s._delayedTrigger("remove:"+p,s,a[c])}}else a[c]=i;if(!r.silent&&e.isObject(i)&&h){var m=[],g=function(t,a){var n,i;if(!(e.indexOf(m,t)>-1))for(var o in m.push(t),t)t.hasOwnProperty(o)&&(n=a+"."+o,i=t[o],e.isEqual(s.get(n),i)||s._delayedChange(n,i,r),e.isObject(i)&&g(i,n))};g(i,u)}}else a[c]||(e.isNumber(d)?a[c]=[]:a[c]={});r.silent||(l.length>1&&h&&s._delayedChange(u,a[c],r),e.isArray(a[c])&&s._delayedTrigger("add:"+u,s,a[c]))})}},{attrPath:function(t){var a;return e.isString(t)?(a=""===t?[""]:t.match(/[^\.\[\]]+/g),a=e.map(a,function(e){return e.match(/^\d+$/)?parseInt(e,10):e})):a=t,a},createAttrStr:function(t){var a=t[0];return e.each(e.rest(t),function(t){a+=e.isNumber(t)?"["+t+"]":"."+t}),a},deepClone:function(e){return JSON.parse(JSON.stringify(e))},walkPath:function(e,t,a,n){for(var i=e,r=0;r<t.length&&(a.call(n||this,i,t.slice(0,r+1),t[r+1]),i=i[t[r]]);r++);},walkThenGet:function(a,n){var i,r=t.NestedModel.attrPath(n);return t.NestedModel.walkPath(a,r,function(t,a){var n=e.last(a);a.length===r.length&&(i=t[n])}),i}})}(e._,e.Backbone)}(this),define("global_libs/backbone/backbone-nested",function(){}),define("ecommerce/models/variant",["global_libs/backbone/backbone-nested"],function(){return Backbone.NestedModel.extend({idAttribute:"variant_id",defaults:{price:0,inventory:-1},validation:{dimensions:{fn:function(e,t,a){if(a.is_digital)return!1;var n=Object.entries(e),i=[];return _.each(n,function(e){null!=e[1]&&""!=e[1]&&null!=e[1]||i.push(e[0])}),console.log("done validating in function",i),i}}},initialize:function(){null===this.get("dimensions")&&(this.attributes.dimensions={}),this.listenTo(this,"change:attributes",function(e,t,a){a&&!0===a.ignoreVariantSort||this.sortAttributes()}),this.listenTo(this,"add",this.bindCollectionEvents),this.bindCollectionEvents(),this.sortAttributes()},bindCollectionEvents:function(){this.collection&&this.collection.productModel&&(this.boundCollection&&(this.stopListening(this.boundCollection),this.stopListening(this.boundCollection.productModel)),this.listenTo(this.collection,"sort",this.sortAttributes),this.listenTo(this.collection.productModel,"sync sort_variants",this.sortAttributes),this.boundCollection=this.collection)},parse:function(e){return null===e.dimensions&&(e.dimensions={}),e},getDescriptor:function(){return _.map(this.get("attributes"),function(e,t){return t+"-"+e}).sort().join("/")},url:function(){return Cargo.API.GetBasePath()+"/ecommerce/v2/variants/"+(this.get("variant_id")||"")},sortAttributes:function(){if(!this.get("is_default")&&this.collection&&this.collection.productModel&&!_.isEmpty(this.collection.productModel.get("attributes"))){var e=_.pick(this.collection.productModel.get("attributes"),function(e,t){return""!==t&&e.length>0});if(!_.isEqual(_.keys(e).sort(),_.keys(this.get("attributes")).sort()))return;var t={};_.each(e,function(e,a){t[a]=this.attributes.attributes[a]},this),this.attributes.attributes=t}}})}),define("ecommerce/collections/variants",["ecommerce/models/variant"],function(e){return Backbone.Collection.extend({model:e,comparator:"sortIndex",initialize:function(e,t){t&&(this.productModel=t.productModel)},parse:function(e){return e.data},setSortIndexes:function(){if(this.productModel){var e=this.cartesianProductOf.apply(this,_.filter(_.map(this.productModel.get("attributes"),function(e,t){return _.without(_.map(e,function(e){return t+"-"+e}),null)}),function(e){return e.length>0}));e=_.map(e,function(e){return e.sort().join("/")}),this.each(function(t){var a=e.indexOf(t.getDescriptor());t.attributes.sortIndex=a}),this.sort()}else console.warn("unable to sort without product model")},cartesianProductOf:function(){return _.reduce(arguments,function(e,t){return _.flatten(_.map(e,function(e){return _.map(t,function(t){return e.concat([t])})}),!0)},[[]])}})}),define("ecommerce/models/product",["ecommerce/collections/variants","global_libs/backbone/backbone-nested"],function(e){return Backbone.NestedModel.extend({idAttribute:"product_id",initialize:function(){this.defaultVariant,this.syncVariants=!0,this.__unfilteredVariantsCollection?this.__unfilteredVariantsCollection.set(this.get("variants")):this.__unfilteredVariantsCollection=new e(this.get("variants"),{productModel:this}),this.__unfilteredVariantsCollection.setSortIndexes(),this.listenTo(this,"change:attributes",function(){this.__unfilteredVariantsCollection.setSortIndexes(),this.variantCollection.sort()}),this.filterVariants(),this.listenTo(this,"change:use_default_variant",function(){this.filterVariants()}),this.listenTo(this,"change:variants",function(e,t,a){!0!==a.from_self&&(this.__unfilteredVariantsCollection.set(t,{ignoreSaveKit:a.ignoreSaveKit}),this.__unfilteredVariantsCollection.setSortIndexes(),this.filterVariants())}),this.listenTo(this.variantCollection,"change update",function(){this.variantCollection.sort({prevent_render:!0}),!1!==this.syncVariants&&this.set("variants",this.variantCollection.toJSON(),{ignoreSaveKit:!0,from_self:!0})})},pauseVariantCollectionSync:function(){this.syncVariants=!1},resumeVariantCollectionSync:function(e){this.syncVariants=!0,!0===e&&this.set("variants",this.variantCollection.toJSON(),{ignoreSaveKit:!0,from_self:!0})},filterVariants:function(t){void 0===t&&(t=this.get("use_default_variant")),this.variantCollection||(this.variantCollection=new e(void 0,{productModel:this})),this.variantCollection.set(this.__unfilteredVariantsCollection.where({is_default:t})),this.variantCollection.sort(),this.attributes.variants=this.variantCollection.toJSON()},getProductVariants:function(){return this.__unfilteredVariantsCollection.where({is_default:!1})},getDefaultVariant:function(){return this.__unfilteredVariantsCollection.findWhere({is_default:!0})},getAttributeVariations:function(e){var t=_.without(_.uniq(this.variantCollection.map(function(t){if(!0===t.get("is_available"))return t.get("attributes")[e]})),void 0),a=this.get("attributes")[e];return a&&t.sort(function(e,t){var n=a.indexOf(e),i=a.indexOf(t);return n<i?-1:n==i?0:1}),t},url:function(){return Cargo.API.GetBasePath()+"/ecommerce/v2/products/"+(this.get("product_id")||"")},parse:function(t,a){if(t.variants){if(_.each(t.variants,function(e){e.dimensions=e.dimensions||{}}),a.ignoreDefaultVariantData){var n=this.getDefaultVariant();if(n)for(var i=0;i<t.variants.length;i++)t.variants[i].is_default&&(t.variants[i]=n.toJSON())}this.__unfilteredVariantsCollection?this.__unfilteredVariantsCollection.set(t.variants,{ignoreSaveKit:a.ignoreSaveKit}):this.__unfilteredVariantsCollection=new e(t.variants,{productModel:this}),this.filterVariants(t.use_default_variant)}return t}})}),define("ecommerce/collections/products",["ecommerce/models/product"],function(e){return Backbone.Collection.extend({model:e,comparator:"sort_index",basePath:Cargo.API.GetBasePath()+"/ecommerce/v2/products/",initialize:function(e){this.orderBy="date_added",this.orderDir="asc",this.totalProductCount=void 0,this.pageSize=250,this.paginationComplete=!1,this.loadedPages=[],this.loadingPages=[],this.idsBeingFetched=[],this.listenTo(this,"destroy",this.deleteProduct)},fetchMultiple:function(e,t){if((t=t||{}).always=t.always||function(){},e){if(_.isArray(e)||(e=e.ids),e=_.unique(e),t.force||(e=_.filter(e,e=>!this.get(e))),0!==e.length)return this.idsBeingFetched=_.union(this.idsBeingFetched,e),this.fetch({url:this.basePath+"list",data:{ids:e},remove:!1,type:"POST",success:function(a,n){this.idsBeingFetched=_.difference(this.idsBeingFetched,e),t.success&&t.success.apply(this,arguments),t.always(n.data)}.bind(this),error:function(){this.idsBeingFetched=_.difference(this.idsBeingFetched,e),t.error&&t.error.apply(this,arguments),t.always()}.bind(this)});t.always([])}else t.always([])},addNewProduct:function(e,t){this.each(function(e){e.get("sort_index")>=0&&e.set("sort_index",e.get("sort_index")+1)}),e.set("sort_index",0),this.add(e,{at:0}),t(e)},deleteProduct:function(e,t,a){var n;void 0!==e.get("sort_index")&&(t.each(function(t){t.get("sort_index")>=e.get("sort_index")&&(n=t.get("sort_index")-1,t.set("sort_index",n))}),a.xhr.success(function(){void 0!==n&&this.fetchProductAtIndex(n+1)}.bind(this)))},fetchProductIndex:function(e,t){$.getJSON(Cargo.API.GetBasePath()+"/ecommerce/v2/products/"+e+"/index?order_by="+this.orderBy+"&order_dir="+this.orderDir).always(function(e,a){t("success"===a?e.index:void 0)})},fetchProductAtIndex:function(e,t){isNaN(e)||this.fetch({url:this.url()+"&offset="+e+"&limit=1",offset:e,remove:!1,success:t})},fetchPageBelongingToProduct:function(e,t){this.fetchProductIndex(e,function(e){if(isNaN(e))return console.warn("Unable to fetch index for page"),void t();this.fetchPage(Math.ceil((e+1)/this.pageSize)).always(t)}.bind(this))},fetchPage:function(e,t){if(this.loadingPages.includes(e))return $.Deferred().reject();this.loadingPages.push(e);var a=this.pageSize*(e-1);return this.fetch({url:this.url()+"&offset="+a+"&limit="+this.pageSize,offset:a,remove:!1,success:function(){var n=this.loadingPages.indexOf(e);n>-1&&this.loadingPages.splice(n,1),this.loadedPages.push(e),!isNaN(this.totalProductCount)&&a+this.pageSize>this.totalProductCount&&(this.paginationComplete=!0),t&&t()}.bind(this)})},getPage:function(e){var t=this.pageSize*(e-1);return this.filter(function(e){return e.get("sort_index")>=t&&e.get("sort_index")<t+this.pageSize},this)},getPageNumberForProduct:function(e){return Math.ceil((e.get("sort_index")+1)/this.pageSize)},hasPage:function(e){return this.loadedPages.includes(e)},isLoadingPage:function(e){return this.loadingPages.includes(e)},parse:function(e,t){var a=e.data;return isNaN(e.count)||(this.totalProductCount=e.count),void 0!==t.offset&&_.each(a,function(e,a){e.sort_index=t.offset+a},this),a},fetch:function(e){return void 0===(e=e||{}).offset&&(e.offset=0),!0===e.fetchAll&&(e.url=this.url()+"&limit=999"),Backbone.Collection.prototype.fetch.apply(this,arguments).then(()=>{!0===e.fetchAll&&(this.paginationComplete=!0)})},url:function(){return this.basePath+"?order_by="+this.orderBy+"&order_dir="+this.orderDir},duplicateProduct:function(e,t){$.ajax({type:"POST",url:this.basePath+e+"/dupe",success:function(e){e&&this.fetchProductIndex(e.product_id,function(a){if(isNaN(a))console.warn("Unable to fetch index for page");else{var n=this.add(e,{at:a});t(n)}}.bind(this))}.bind(this),dataType:"json"})}})}),define("ecommerce/models/shop",["global_libs/backbone/backbone-nested"],function(){if(Cargo.contentWindow&&Cargo.contentWindow.Cargo.Ecommerce)try{return Cargo.contentWindow.Cargo.Ecommerce.Model.shop}catch(e){console.error(e)}if(parent!==window)try{if(parent.Cargo&&parent.Cargo.Ecommerce)return parent.Cargo.Ecommerce.Model.shop}catch(e){console.error(e)}return new(Backbone.NestedModel.extend({defaults:{unit_system:"imperial",currency:"USD",locale:"en-US"},validation:{shop_name:{required:!0,msg:"Please enter a shop name"},shop_email:{required:!0,pattern:"email",msg:"Please enter a valid email"},shop_address1:{required:!0,msg:"Please enter a shop address"},shop_country:{required:!0,msg:"Please enter a shop country"},shop_city:{required:!0,msg:"Please enter a shop city"},hasInvalidAddress:{fn:function(e,t,a,n){if(n.shop_address1||n.shop_country||n.shop_city)return"One or more address fields are missing"}},hasNoPaymentProvider:{fn:function(e,t,a){if("string"!=typeof a.stripe_public_key&&"string"!=typeof a.paypal_client_id)return"Enable Stripe or Paypal to start accepting payments"}},hasNoAddon:{fn:function(e,t,a){if(!0!==a.has_commerce_addon)return"Shop is cannot be used until the Commerce addon is purchased."}},hasInvalidContactInfo:{fn:function(e,t,a,n){if(n.hasInvalidAddress||n.shop_email||n.shop_name)return"Required contact info missing"}},invalidTaxConfiguration:{fn:function(e,t,a,n){if("flat_rate"===a.tax_method){if(parent.Cargo.Ecommerce.Collection.taxzones&&0==parent.Cargo.Ecommerce.Collection.taxzones.length)return"No Tax zones are defined.";parent.Cargo.Ecommerce.Collection.taxzones||console.warn("Unable to verify shipping zone availablity")}}}},initialize:function(){var e=(Cargo.contentWindow?Cargo.contentWindow.document:document).querySelector('script[type="text/json"][data-set="Shop"]');if(e)try{var t=JSON.parse(e.textContent);null!==t&&this.set(this.enforceDefaults(t))}catch(e){console.error(e)}},canTakePayments:function(){var e=this.get("is_enabled"),t=this.get("has_valid_config"),a=this.get("has_commerce_addon");return this.hasLogged||(this.hasLogged=!0),e&&t&&a},url:function(){return Cargo.API.GetBasePath()+"/ecommerce/v2/shop/"+(this.id||Cargo.Model.Site.get("account_shop_id"))},parse:function(e){return this.enforceDefaults(e)},enforceDefaults:function(e){return"string"!=typeof e.currency&&(e.currency=this.defaults.currency),"string"!=typeof e.unit_system&&(e.unit_system=this.defaults.unit_system),"string"!=typeof e.locale&&(e.locale=this.defaults.locale),null!=e.checkout_note_title&&""!=e.checkout_note_title||(e.checkout_note_title="Noteâ€¦"),e}}))}),define("ecommerce/collections/cart",["ecommerce/models/shop"],function(e){return Backbone.Collection.extend({comparator:"sort_index",initialize:function(e){this.restoreCartFromLocalStorage(),this.on("update reset change:quantity",this.saveCartToLocalStorage)},add:function(t,a){if(e.canTakePayments()||!0===Cargo.API.Config.is_template){if(void 0!==t){if(t.toJSON&&(t=t.toJSON()),(null==(a=a||{}).amount||isNaN(a.amount))&&(a.amount=1),null!==t.inventory&&a.amount>t.inventory){if(t.inventory<=0)return void Cargo.Modal.Alert({message:"Product is out of stock"});a.amount=t.inventory}var n=t.product_id,i=t.variant_id,r=this.findWhere({product_id:n,variant_id:i});if(r){var o=r.get("quantity")+a.amount;return null!==t.inventory&&o>t.inventory?void Cargo.View.Following.loadSection("cart",!0):(r.set("quantity",o),r)}return arguments[0]={product_id:n,variant_id:i,quantity:a.amount},Backbone.Collection.prototype.add.apply(this,arguments)}}else Cargo.Modal.Alert({message:"Coming Soon"})},clearCartFromLocalStorage:function(){try{localStorage.removeItem("cargo-ecom-serialized-cart")}catch(e){console.log(e)}},saveCartToLocalStorage:function(){try{var e=_.map(this.filter(function(e){return e.get("quantity")>0}),function(e){return e.toJSON()});localStorage.setItem("cargo-ecom-serialized-cart",JSON.stringify(e))}catch(e){console.error(e)}},restoreCartFromLocalStorage:function(){var e=localStorage.getItem("cargo-ecom-serialized-cart");if(null!==e&&e.length>0)try{this.set(JSON.parse(e))}catch(e){console.error(e)}},getTotalCartItemCount:function(){return this.reduce(function(e,t){return e+t.get("quantity")},0)}})}),define("text",["module"],function(e){"use strict";var t,a,n,i,r,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],s=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,d="undefined"!=typeof location&&location.href,c=d&&location.protocol&&location.protocol.replace(/\:/,""),u=d&&location.hostname,h=d&&(location.port||void 0),p={},m=e.config&&e.config()||{};function g(e,t){return void 0===e||""===e?t:e}return t={version:"2.0.16",strip:function(e){if(e){var t=(e=e.replace(s,"")).match(l);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:m.createXhr||function(){var e,t,a;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;t<3;t+=1){a=o[t];try{e=new ActiveXObject(a)}catch(e){}if(e){o=[a];break}}return e},parseName:function(e){var t,a,n,i=!1,r=e.lastIndexOf("."),o=0===e.indexOf("./")||0===e.indexOf("../");return-1!==r&&(!o||r>1)?(t=e.substring(0,r),a=e.substring(r+1)):t=e,-1!==(r=(n=a||t).indexOf("!"))&&(i="strip"===n.substring(r+1),n=n.substring(0,r),a?a=n:t=n),{moduleName:t,ext:a,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,a,n,i){var r,o,s,l=t.xdRegExp.exec(e);return!l||(r=l[2],s=(o=(o=l[3]).split(":"))[1],o=o[0],(!r||r===a)&&(!o||o.toLowerCase()===n.toLowerCase())&&(!s&&!o||function(e,t,a,n){if(t===n)return!0;if(e===a){if("http"===e)return g(t,"80")===g(n,"80");if("https"===e)return g(t,"443")===g(n,"443")}return!1}(r,s,a,i)))},finishLoad:function(e,a,n,i){n=a?t.strip(n):n,m.isBuild&&(p[e]=n),i(n)},load:function(e,a,n,i){if(i&&i.isBuild&&!i.inlineText)n();else{m.isBuild=i&&i.isBuild;var r=t.parseName(e),o=r.moduleName+(r.ext?"."+r.ext:""),s=a.toUrl(o),l=m.useXhr||t.useXhr;0!==s.indexOf("empty:")?!d||l(s,c,u,h)?t.get(s,function(a){t.finishLoad(e,r.strip,a,n)},function(e){n.error&&n.error(e)}):a([o],function(e){t.finishLoad(r.moduleName+"."+r.ext,r.strip,e,n)},function(e){n.error&&n.error(e)}):n()}},write:function(e,a,n,i){if(p.hasOwnProperty(a)){var r=t.jsEscape(p[a]);n.asModule(e+"!"+a,"define(function () { return '"+r+"';});\n")}},writeFile:function(e,a,n,i,r){var o=t.parseName(a),s=o.ext?"."+o.ext:"",l=o.moduleName+s,d=n.toUrl(o.moduleName+s)+".js";t.load(l,n,function(a){var n=function(e){return i(d,e)};n.asModule=function(e,t){return i.asModule(e,d,t)},t.write(e,l,n,r)},r)}},"node"===m.env||!m.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(a=require.nodeRequire("fs"),t.get=function(e,t,n){try{var i=a.readFileSync(e,"utf8");"\ufeff"===i[0]&&(i=i.substring(1)),t(i)}catch(e){n&&n(e)}}):"xhr"===m.env||!m.env&&t.createXhr()?t.get=function(e,a,n,i){var r,o=t.createXhr();if(o.open("GET",e,!0),i)for(r in i)i.hasOwnProperty(r)&&o.setRequestHeader(r.toLowerCase(),i[r]);m.onXhr&&m.onXhr(o,e),o.onreadystatechange=function(t){var i,r;4===o.readyState&&((i=o.status||0)>399&&i<600?((r=new Error(e+" HTTP status: "+i)).xhr=o,n&&n(r)):a(o.responseText),m.onXhrComplete&&m.onXhrComplete(o,e))},o.send(null)}:"rhino"===m.env||!m.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var a,n,i=new java.io.File(e),r=java.lang.System.getProperty("line.separator"),o=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(i),"utf-8")),s="";try{for(a=new java.lang.StringBuffer,(n=o.readLine())&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&a.append(n);null!==(n=o.readLine());)a.append(r),a.append(n);s=String(a.toString())}finally{o.close()}t(s)}:("xpconnect"===m.env||!m.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,i=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),r="@mozilla.org/windows-registry-key;1"in n,t.get=function(e,t){var a,o,s,l={};r&&(e=e.replace(/\//g,"\\")),s=new FileUtils.File(e);try{(a=n["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream)).init(s,1,0,!1),(o=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream)).init(a,"utf-8",a.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(a.available(),l),o.close(),a.close(),t(l.value)}catch(e){throw new Error((s&&s.path||"")+": "+e)}}),t}),define("text!ecommerce/templates/client/widget.html",[],function(){return'<% if(product === undefined) { %>\n\n\tProduct not found\n\n<% } else { %>\n\n\t\x3c!-- <% if(product.get(\'use_default_variant\')) { %>\n\t\t<%= product.get(\'name\') %>\n\t<% } %> --\x3e\n\n\t<% if(options.showPrice !== false) { %>\n\t\t<div class="product_price price"></div>\n\t<% } %>\n\n\t<% if(product.get(\'use_default_variant\') === false) { %>\n\t\t\n\t\t<% if(options.mergevariantdropdowns) { %>\n\n\t\t\t<select class="dropdown" variant-list>\n\n\t\t\t\t<% _.each(product.get(\'variants\'), function(productVariation){ %>\n\t\t\t\t\t<option value="<%= productVariation.variant_id %>"><%= _.values(productVariation.attributes).join(\', \') %></option>\n\t\t\t\t<% }) %>\n\n\t\t\t</select>\n\n\t\t<% } else { %>\n\n\t\t\t<% _.each(_.keys(product.get(\'attributes\')), function(productAttribute){ %>\n\n\t\t\t\t<select variant-option="<%= productAttribute %>" class="dropdown">\n\t\t\t\t\t<option disabled><%= productAttribute %></option>\n\t\t\t\t\t\n\t\t\t\t\t<% _.each(product.getAttributeVariations(productAttribute), function(attributeVariation){ %>\n\t\t\t\t\t\t<option value="<%= attributeVariation %>"><%= attributeVariation %></option>\n\t\t\t\t\t<% }) %>\n\n\t\t\t\t</select>\n\n\t\t\t<% }); %>\n\n\t\t<% } %>\n\n\t<% } %>\n\n\t<a data-add-to-cart class="button"></a>\n\t\n<% } %>'}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("ecommerce/libs/currency",t):(e=e||self).currency=t()}(this,function(){function e(r,o){if(!(this instanceof e))return new e(r,o);o=Object.assign({},a,o);var s=Math.pow(10,o.precision);this.intValue=r=t(r,o),this.value=r/s,o.increment=o.increment||1/s,o.groups=o.useVedic?i:n,this.s=o,this.p=s}function t(t,a){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],i=a.decimal,r=a.errorOnInvalid,o=Math.pow(10,a.precision),s="number"==typeof t;if(s||t instanceof e)o*=s?t:t.value;else if("string"==typeof t)r=new RegExp("[^-\\d"+i+"]","g"),i=new RegExp("\\"+i,"g"),o=(o*=t.replace(/\((.*)\)/,"-$1").replace(r,"").replace(i,"."))||0;else{if(r)throw Error("Invalid Input");o=0}return o=o.toFixed(4),n?Math.round(o):o}var a={symbol:"$",separator:",",decimal:".",formatWithSymbol:!1,errorOnInvalid:!1,precision:2,pattern:"!#",negativePattern:"-!#"},n=/(\d)(?=(\d{3})+\b)/g,i=/(\d)(?=(\d\d)+\d\b)/g;return e.prototype={add:function(a){var n=this.s,i=this.p;return e((this.intValue+t(a,n))/i,n)},subtract:function(a){var n=this.s,i=this.p;return e((this.intValue-t(a,n))/i,n)},multiply:function(t){var a=this.s;return e(this.intValue*t/Math.pow(10,a.precision),a)},divide:function(a){var n=this.s;return e(this.intValue/t(a,n,!1),n)},distribute:function(t){for(var a=this.intValue,n=this.p,i=this.s,r=[],o=Math[0<=a?"floor":"ceil"](a/t),s=Math.abs(a-o*t);0!==t;t--){var l=e(o/n,i);0<s--&&(l=0<=a?l.add(1/n):l.subtract(1/n)),r.push(l)}return r},dollars:function(){return~~this.value},cents:function(){return~~(this.intValue%this.p)},format:function(e){var t=this.s,a=t.pattern,n=t.negativePattern,i=t.formatWithSymbol,r=t.symbol,o=t.separator,s=t.decimal;t=t.groups;var l=(this+"").replace(/^-/,"").split("."),d=l[0];return l=l[1],void 0===e&&(e=i),(0<=this.value?a:n).replace("!",e?r:"").replace("#","".concat(d.replace(t,"$1"+o)).concat(l?s+l:""))},toString:function(){var e=this.s,t=e.increment;return(Math.round(this.intValue/this.p/t)*t).toFixed(e.precision)},toJSON:function(){return this.value}},e}),define("ecommerce/helpers",["ecommerce/models/shop","ecommerce/libs/currency"],function(e,t){var a=["USD","AED","AFN","ALL","AMD","ANG","AOA","ARS","AUD","AWG","AZN","BAM","BBD","BDT","BGN","BIF","BMD","BND","BOB","BRL","BSD","BWP","BZD","CAD","CDF","CHF","CLP","CNY","COP","CRC","CVE","CZK","DJF","DKK","DOP","DZD","EGP","ETB","EUR","FJD","FKP","GBP","GEL","GIP","GMD","GNF","GTQ","GYD","HKD","HNL","HRK","HTG","HUF","IDR","ILS","INR","ISK","JMD","JPY","KES","KGS","KHR","KMF","KRW","KYD","KZT","LAK","LBP","LKR","LRD","LSL","MAD","MDL","MGA","MKD","MMK","MNT","MOP","MRO","MUR","MVR","MWK","MXN","MYR","MZN","NAD","NGN","NIO","NOK","NPR","NZD","PAB","PEN","PGK","PHP","PKR","PLN","PYG","QAR","RON","RSD","RUB","RWF","SAR","SBD","SCR","SEK","SGD","SHP","SLL","SOS","SRD","STD","SZL","THB","TJS","TOP","TRY","TTD","TWD","TZS","UAH","UGX","UYU","UZS","VND","VUV","WST","XAF","XCD","XOF","XPF","YER","ZAR","ZMW"],n=["BIF","DJF","GNF","JPY","KMF","KRW","MGA","PYG","RWF","VND","VUV","XAF","XOF","XPF"],i={AED:"Ø¯.Ø¥",AFN:"Ø‹",ALL:"L",AMD:"Ö",ANG:"Æ’",AOA:"Kz",ARS:"$",AUD:"$",AWG:"Æ’",AZN:"â‚¼",BAM:"KM",BBD:"$",BDT:"à§³",BGN:"Ð»Ð²",BHD:".Ø¯.Ø¨",BIF:"FBu",BMD:"$",BND:"$",BOB:"$b",BRL:"R$",BSD:"$",BTC:"à¸¿",BTN:"Nu.",BWP:"P",BYR:"p.",BZD:"BZ$",CAD:"$",CDF:"FC",CHF:"CHF",CLP:"$",CNY:"Â¥",COP:"$",CRC:"â‚¡",CUC:"$",CUP:"â‚±",CVE:"$",CZK:"KÄ",DJF:"Fdj",DKK:"kr",DOP:"RD$",DZD:"Ø¯Ø¬",EEK:"kr",EGP:"Â£",ERN:"Nfk",ETB:"Br",ETH:"Îž",EUR:"â‚¬",FJD:"$",FKP:"Â£",GBP:"Â£",GEL:"â‚¾",GGP:"Â£",GHC:"â‚µ",GHS:"GHâ‚µ",GIP:"Â£",GMD:"D",GNF:"FG",GTQ:"Q",GYD:"$",HKD:"$",HNL:"L",HRK:"kn",HTG:"G",HUF:"Ft",IDR:"Rp",ILS:"â‚ª",IMP:"Â£",INR:"â‚¹",IQD:"Ø¹.Ø¯",IRR:"ï·¼",ISK:"kr",JEP:"Â£",JMD:"J$",JOD:"JD",JPY:"Â¥",KES:"KSh",KGS:"Ð»Ð²",KHR:"áŸ›",KMF:"CF",KPW:"â‚©",KRW:"â‚©",KWD:"KD",KYD:"$",KZT:"Ð»Ð²",LAK:"â‚­",LBP:"Â£",LKR:"â‚¨",LRD:"$",LSL:"M",LTC:"Å",LTL:"Lt",LVL:"Ls",LYD:"LD",MAD:"MAD",MDL:"lei",MGA:"Ar",MKD:"Ð´ÐµÐ½",MMK:"K",MNT:"â‚®",MOP:"MOP$",MRO:"UM",MUR:"â‚¨",MVR:"Rf",MWK:"MK",MXN:"$",MYR:"RM",MZN:"MT",NAD:"$",NGN:"â‚¦",NIO:"C$",NOK:"kr",NPR:"â‚¨",NZD:"$",OMR:"ï·¼",PAB:"B/.",PEN:"S/.",PGK:"K",PHP:"â‚±",PKR:"â‚¨",PLN:"zÅ‚",PYG:"Gs",QAR:"ï·¼",RMB:"ï¿¥",RON:"lei",RSD:"Ð”Ð¸Ð½.",RUB:"â‚½",RWF:"Râ‚£",SAR:"ï·¼",SBD:"$",SCR:"â‚¨",SDG:"Ø¬.Ø³.",SEK:"kr",SGD:"$",SHP:"Â£",SLL:"Le",SOS:"S",SRD:"$",SSP:"Â£",STD:"Db",SVC:"$",SYP:"Â£",SZL:"E",THB:"à¸¿",TJS:"SM",TMT:"T",TND:"Ø¯.Øª",TOP:"T$",TRL:"â‚¤",TRY:"â‚º",TTD:"TT$",TVD:"$",TWD:"NT$",TZS:"TSh",UAH:"â‚´",UGX:"USh",USD:"$",UYU:"$U",UZS:"Ð»Ð²",VEF:"Bs",VND:"â‚«",VUV:"VT",WST:"WS$",XAF:"FCFA",XBT:"Éƒ",XCD:"$",XOF:"CFA",XPF:"â‚£",YER:"ï·¼",ZAR:"R",ZWD:"Z$"},r={USD:"US Dollar",AED:"United Arab Emirates Dirham",AFN:"Afghan Afghani",ALL:"Albanian Lek",AMD:"Armenian Dram",ANG:"Netherlands Antillean Guilder",AOA:"Angolan Kwanza",ARS:"Argentine Peso",AUD:"Australian Dollar",AWG:"Aruban Florin",AZN:"Azerbaijani Manat",BAM:"Bosnia-Herzegovina Convertible Mark",BBD:"Barbadian Dollar",BDT:"Bangladeshi Taka",BGN:"Bulgarian Lev",BIF:"Burundian Franc",BMD:"Bermudan Dollar",BND:"Brunei Dollar",BOB:"Bolivian Boliviano",BRL:"Brazilian Real",BSD:"Bahamian Dollar",BWP:"Botswanan Pula",BZD:"Belize Dollar",CAD:"Canadian Dollar",CDF:"Congolese Franc",CHF:"Swiss Franc",CLP:"Chilean Peso",CNY:"Chinese Yuan",COP:"Colombian Peso",CRC:"Costa Rican ColÃ³n",CVE:"Cape Verdean Escudo",CZK:"Czech Koruna",DJF:"Djiboutian Franc",DKK:"Danish Krone",DOP:"Dominican Peso",DZD:"Algerian Dinar",EGP:"Egyptian Pound",ETB:"Ethiopian Birr",EUR:"Euro",FJD:"Fijian Dollar",FKP:"Falkland Islands Pound",GBP:"British Pound",GEL:"Georgian Lari",GIP:"Gibraltar Pound",GMD:"Gambian Dalasi",GNF:"Guinean Franc",GTQ:"Guatemalan Quetzal",GYD:"Guyanaese Dollar",HKD:"Hong Kong Dollar",HNL:"Honduran Lempira",HRK:"Croatian Kuna",HTG:"Haitian Gourde",HUF:"Hungarian Forint",IDR:"Indonesian Rupiah",ILS:"Israeli New Shekel",INR:"Indian Rupee",ISK:"Icelandic KrÃ³na",JMD:"Jamaican Dollar",JPY:"Japanese Yen",KES:"Kenyan Shilling",KGS:"Kyrgystani Som",KHR:"Cambodian Riel",KMF:"Comorian Franc",KRW:"South Korean Won",KYD:"Cayman Islands Dollar",KZT:"Kazakhstani Tenge",LAK:"Laotian Kip",LBP:"Lebanese Pound",LKR:"Sri Lankan Rupee",LRD:"Liberian Dollar",LSL:"Lesotho Loti",MAD:"Moroccan Dirham",MDL:"Moldovan Leu",MGA:"Malagasy Ariary",MKD:"Macedonian Denar",MMK:"Myanmar Kyat",MNT:"Mongolian Tugrik",MOP:"Macanese Pataca",MRO:"Mauritanian Ouguiya",MUR:"Mauritian Rupee",MVR:"Maldivian Rufiyaa",MWK:"Malawian Kwacha",MXN:"Mexican Peso",MYR:"Malaysian Ringgit",MZN:"Mozambican Metical",NAD:"Namibian Dollar",NGN:"Nigerian Naira",NIO:"Nicaraguan CÃ³rdoba",NOK:"Norwegian Krone",NPR:"Nepalese Rupee",NZD:"New Zealand Dollar",PAB:"Panamanian Balboa",PEN:"Peruvian Sol",PGK:"Papua New Guinean Kina",PHP:"Philippine Peso",PKR:"Pakistani Rupee",PLN:"Polish Zloty",PYG:"Paraguayan Guarani",QAR:"Qatari Rial",RON:"Romanian Leu",RSD:"Serbian Dinar",RUB:"Russian Ruble",RWF:"Rwandan Franc",SAR:"Saudi Riyal",SBD:"Solomon Islands Dollar",SCR:"Seychellois Rupee",SEK:"Swedish Krona",SGD:"Singapore Dollar",SHP:"St. Helena Pound",SLL:"Sierra Leonean Leone",SOS:"Somali Shilling",SRD:"Surinamese Dollar",STD:"SÃ£o TomÃ© & PrÃ­ncipe Dobra",SZL:"Swazi Lilangeni",THB:"Thai Baht",TJS:"Tajikistani Somoni",TOP:"Tongan PaÊ»anga",TRY:"Turkish Lira",TTD:"Trinidad & Tobago Dollar",TWD:"New Taiwan Dollar",TZS:"Tanzanian Shilling",UAH:"Ukrainian Hryvnia",UGX:"Ugandan Shilling",UYU:"Uruguayan Peso",UZS:"Uzbekistani Som",VND:"Vietnamese Dong",VUV:"Vanuatu Vatu",WST:"Samoan Tala",XAF:"Central African CFA Franc",XCD:"East Caribbean Dollar",XOF:"West African CFA Franc",XPF:"CFP Franc",YER:"Yemeni Rial",ZAR:"South African Rand",ZMW:"Zambian Kwacha"},o={aa:"Afar",ab:"Abkhazian",af:"Afrikaans",ak:"Akan",am:"Amharic",an:"Aragonese",ar:"Arabic",as:"Assamese",av:"Avar",ay:"Aymara",az:"Azerbaijani",ba:"Bashkir",be:"Belarusian",bg:"Bulgarian",bh:"Bihari",bi:"Bislama",bm:"Bambara",bn:"Bengali",bo:"Tibetan",br:"Breton",bs:"Bosnian",ca:"Catalan",ce:"Chechen",ch:"Chamorro",co:"Corsican",cr:"Cree",cs:"Czech",cu:"Old Church Slavonic / Old Bulgarian",cv:"Chuvash",cy:"Welsh",da:"Danish",de:"German",dv:"Divehi",dz:"Dzongkha",ee:"Ewe",el:"Greek",en:"English",eo:"Esperanto",es:"Spanish",et:"Estonian",eu:"Basque",fa:"Persian",ff:"Peul",fi:"Finnish",fj:"Fijian",fo:"Faroese",fr:"French",fy:"West Frisian",ga:"Irish",gd:"Scottish Gaelic",gl:"Galician",gn:"Guarani",gu:"Gujarati",gv:"Manx",ha:"Hausa",he:"Hebrew",hi:"Hindi",ho:"Hiri Motu",hr:"Croatian",ht:"Haitian",hu:"Hungarian",hy:"Armenian",hz:"Herero",ia:"Interlingua",id:"Indonesian",ie:"Interlingue",ig:"Igbo",ii:"Sichuan Yi",ik:"Inupiak",io:"Ido",is:"Icelandic",it:"Italian",iu:"Inuktitut",ja:"Japanese",jv:"Javanese",ka:"Georgian",kg:"Kongo",ki:"Kikuyu",kj:"Kuanyama",kk:"Kazakh",kl:"Greenlandic",km:"Cambodian",kn:"Kannada",ko:"Korean",kr:"Kanuri",ks:"Kashmiri",ku:"Kurdish",kv:"Komi",kw:"Cornish",ky:"Kyrgyz",la:"Latin",lb:"Luxembourgish",lg:"Ganda",li:"Limburgian",ln:"Lingala",lo:"Laotian",lt:"Lithuanian",lu:"Luba-Katanga",lv:"Latvian",mg:"Malagasy",mh:"Marshallese",mi:"Maori",mk:"Macedonian",ml:"Malayalam",mn:"Mongolian",mo:"Moldovan",mr:"Marathi",ms:"Malay",mt:"Maltese",my:"Burmese",na:"Nauruan",nb:"Norwegian BokmÃ¥l",nd:"North Ndebele",ne:"Nepali",ng:"Ndonga",nl:"Dutch",nn:"Norwegian Nynorsk",no:"Norwegian",nr:"South Ndebele",nv:"Navajo",ny:"Chichewa",oc:"Occitan",oj:"Ojibwa",om:"Oromo",or:"Oriya",os:"Ossetian / Ossetic",pa:"Panjabi / Punjabi",pi:"Pali",pl:"Polish",ps:"Pashto",pt:"Portuguese",qu:"Quechua",rm:"Raeto Romance",rn:"Kirundi",ro:"Romanian",ru:"Russian",rw:"Rwandi",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",se:"Northern Sami",sg:"Sango",sh:"Serbo-Croatian",si:"Sinhalese",sk:"Slovak",sl:"Slovenian",sm:"Samoan",sn:"Shona",so:"Somalia",sq:"Albanian",sr:"Serbian",ss:"Swati",st:"Southern Sotho",su:"Sundanese",sv:"Swedish",sw:"Swahili",ta:"Tamil",te:"Telugu",tg:"Tajik",th:"Thai",ti:"Tigrinya",tk:"Turkmen",tl:"Tagalog / Filipino",tn:"Tswana",to:"Tonga",tr:"Turkish",ts:"Tsonga",tt:"Tatar",tw:"Twi",ty:"Tahitian",ug:"Uyghur",uk:"Ukrainian",ur:"Urdu",uz:"Uzbek",ve:"Venda",vi:"Vietnamese",vo:"VolapÃ¼k",wa:"Walloon",wo:"Wolof",xh:"Xhosa",yi:"Yiddish",yo:"Yoruba",za:"Zhuang",zh:"Chinese",zu:"Zulu"},s=["name","continent","currency","languages","emoji"],l={AF:"Africa",AN:"Antarctica",AS:"Asia",EU:"Europe",NA:"North America",OC:"Oceania",SA:"South America"},d={AR:{label:"Provinces",areas:{B:"Buenos Aires",K:"Catamarca",H:"Chaco",U:"Chubut",C:"Ciudad de Buenos Aires",X:"CÃ³rdoba",W:"Corrientes",E:"Entre RÃ­os",P:"Formosa",Y:"Jujuy",L:"La Pampa",F:"La Rioja",M:"Mendoza",N:"Misiones",Q:"NeuquÃ©n",R:"RÃ­o Negro",A:"Salta",J:"San Juan",D:"San Luis",Z:"Santa Cruz",S:"Santa Fe",G:"Santiago del Estero",V:"Tierra del Fuego",T:"TucumÃ¡n"}},AU:{label:"States",areas:{ACT:"Australian Capital Territory",NSW:"New South Wales",NT:"Northern Territory",QLD:"Queensland",SA:"South Australia",TAS:"Tasmania",VIC:"Victoria",WA:"Western Australia"}},BR:{label:"States",areas:{AC:"Acre",AL:"Alagoas",AM:"Amazonas",AP:"Amapa",BA:"Bahia",CE:"Ceara",DF:"Distrito Federal",ES:"Espirito Santo",GO:"Goias",MA:"Maranhao",MG:"Minas Gerais",MS:"Mato Grosso do Sul",MT:"Mato Grosso",PA:"Para",PB:"Paraiba",PE:"Pernambuco",PI:"Piaui",PR:"Parana",RJ:"Rio de Janeiro",RN:"Rio Grande do Norte",RO:"Rondonia",RR:"Roraima",RS:"Rio Grande do Sul",SC:"Santa Catarina",SE:"Sergipe",SP:"Sao Paulo",TO:"Tocantins"}},CA:{label:"Provinces",areas:{AB:"Alberta",BC:"British Columbia",MB:"Manitoba",NB:"New Brunswick",NL:"Newfoundland",NT:"Northwest Territories",NS:"Nova Scotia",NU:"Nunavut",ON:"Ontario",PE:"Prince Edward Island",QC:"Quebec",SK:"Saskatchewan",YT:"Yukon Territory"}},CL:{label:"Regions",areas:{AI:"AysÃ©n del General Carlos IbÃ¡Ã±ez del Campo",AN:"Antofagasta",AR:"AraucanÃ­a",AP:"Arica y Parinacota",AT:"Atacama",BI:"BiobÃ­o",CO:"Coquimbo",LI:"Libertador General Bernardo O'Higgins",LL:"Los Lagos",LR:"Los RÃ­os",MA:"Magallanes y de la AntÃ¡rtica Chilena",ML:"Maule",RM:"Metropolitana de Santiago",TA:"TarapacÃ¡",VS:"ValparaÃ­so"}},CN:{label:"Provinces",areas:{BJ:"Beijing",SH:"Shanghai",GD:"Guangdong",TJ:"Tianjin",HE:"Hebei",SX:"Shanxi",NM:"Inner Mongolia",LN:"Liaoning",JL:"Jilin",HL:"Heilongjiang",JS:"Jiangsu",ZJ:"Zhejiang",AH:"Anhui",FJ:"Fujian",JX:"Jiangxi",SD:"Shandong",HA:"Henan",HB:"Hubei",HN:"Hunan",GX:"Guangxi",HI:"Hainan",CQ:"Chongqing",SC:"Sichuan",GZ:"Guizhou",YN:"Yunnan",XZ:"Tibet",SN:"Shaanxi",GS:"Gansu",QH:"Qinghai",NX:"Ningxia Hui",XJ:"Xinjiang Uyghur"}},EG:{label:"Governorates",areas:{ALX:"Alexandria",ASN:"Aswan",AST:"Asyut",BH:"Beheira",BNS:"Beni Suef",C:"Cairo",DK:"Dakahlia",DT:"Damietta",FYM:"Faiyum",GH:"Gharbia",GZ:"Giza",IS:"Ismailia",KFS:"Kafr el-Sheikh",MT:"Matruh",MN:"Minya",MNF:"Monufia",WAD:"New Valley",SIN:"North Sinai",PTS:"Port Said",KB:"Qalyubia",KN:"Qena",BA:"Red Sea",SHR:"Sharqia",SHG:"Sohag",JS:"South Sinai",SUZ:"Suez",LX:"Luxor"}},HK:{label:"Regions",areas:{Kowloon:"Kowloon","Hong Kong Island":"Hong Kong Island","New Territories":"New Territories"}},IN:{label:"States",areas:{AP:"Andhra Pradesh",AR:"Arunachal Pradesh",AS:"Assam",BR:"Bihar",CT:"Chhattisgarh",GA:"Goa",GJ:"Gujarat",HR:"Haryana",HP:"Himachal Pradesh",JK:"Jammu and Kashmir",JH:"Jharkhand",KA:"Karnataka",KL:"Kerala",MP:"Madhya Pradesh",MH:"Maharashtra",MN:"Manipur",ML:"Meghalaya",MZ:"Mizoram",NL:"Nagaland",OR:"Odisha",PB:"Punjab",RJ:"Rajasthan",SK:"Sikkim",TN:"Tamil Nadu",TR:"Tripura",UP:"Uttar Pradesh",UT:"Uttarakhand",WB:"West Bengal",AN:"Andaman and Nicobar Islands",CH:"Chandigarh",DN:"Dadra and Nagar Haveli",DD:"Daman and Diu",LD:"Lakshadweep",DL:"National Capital Territory of Delhi",PY:"Puducherry"}},ID:{label:"Provinces",areas:{AC:"Aceh",BA:"Bali",BB:"Bangka Belitung",BT:"Banten",BE:"Bengkulu",JK:"DKI Jakarta",YO:"D.I. Yogyakarta",GO:"Gorontalo",JA:"Jambi",JB:"Jawa Barat",JT:"Jawa Tengah",JI:"Jawa Timur",KB:"Kalimantan Barat",KS:"Kalimantan Selatan",KT:"Kalimantan Tengah",KI:"Kalimantan Timur",KR:"Kepulauan Riau",LA:"Lampung",MA:"Maluku",MU:"Maluku Utara",NB:"Nusa Tenggara Barat",NT:"Nusa Tenggara Timur",PA:"Papua",PB:"Papua Barat",RI:"Riau",SR:"Sulawesi Barat",SN:"Sulawesi Selatan",ST:"Sulawesi Tengah",SG:"Sulawesi Tenggara",SA:"Sulawesi Utara",SB:"Sumatera Barat",SS:"Sumatera Selatan",SU:"Sumatera Utara"}},IE:{label:"Counties",areas:{CW:"Carlow",CN:"Cavan",CE:"Clare",CO:"Cork",DL:"Donegal",D:"Dublin",G:"Galway",KY:"Kerry",KE:"Kildare",KK:"Kilkenny",LS:"Laois",LM:"Leitrim",LK:"Limerick",LD:"Longford",LH:"Louth",MO:"Mayo",MH:"Meath",MN:"Monaghan",OY:"Offaly",RN:"Roscommon",SO:"Sligo",TA:"Tipperary",WD:"Waterford",WH:"Westmeath",WX:"Wexford",WW:"Wicklow"}},IT:{label:"Provinces",areas:{AG:"Agrigento",AL:"Alessandria",AN:"Ancona",AO:"Valle d'Aosta/VallÃˆe d'Aoste",AP:"Ascoli Piceno",AQ:"L'Aquila",AR:"Arezzo",AT:"Asti",AV:"Avellino",BA:"Bari",BG:"Bergamo",BI:"Biella",BL:"Belluno",BN:"Benevento",BO:"Bologna",BR:"Brindisi",BS:"Brescia",BT:"Barletta-Andria-Trani",BZ:"Bolzano/Bozen",CA:"Cagliari",CB:"Campobasso",CE:"Caserta",CH:"Chieti",CI:"Carbonia-Iglesias",CL:"Caltanissetta",CN:"Cuneo",CO:"Como",CR:"Cremona",CS:"Cosenza",CT:"Catania",CZ:"Catanzaro",EN:"Enna",FC:"ForlÃ-Cesena",FE:"Ferrara",FG:"Foggia",FI:"Firenze",FM:"Fermo",FR:"Frosinone",GE:"Genova",GO:"Gorizia",GR:"Grosseto",IM:"Imperia",IS:"Isernia",KR:"Crotone",LC:"Lecco",LE:"Lecce",LI:"Livorno",LO:"Lodi",LT:"Latina",LU:"Lucca",MB:"Monza e Brianza",MC:"Macerata",ME:"Messina",MI:"Milano",MN:"Mantova",MO:"Modena",MS:"Massa-Carrara",MT:"Matera",NA:"Napoli",NO:"Novara",NU:"Nuoro",OG:"Ogliastra",OR:"Oristano",OT:"Olbia-Tempio",PA:"Palermo",PC:"Piacenza",PD:"Padova",PE:"Pescara",PG:"Perugia",PI:"Pisa",PN:"Pordenone",PO:"Prato",PR:"Parma",PT:"Pistoia",PU:"Pesaro e Urbino",PV:"Pavia",PZ:"Potenza",RA:"Ravenna",RC:"Reggio di Calabria",RE:"Reggio nell'Emilia",RG:"Ragusa",RI:"Rieti",RM:"Roma",RN:"Rimini",RO:"Rovigo",SA:"Salerno",SI:"Siena",SO:"Sondrio",SP:"La Spezia",SR:"Siracusa",SS:"Sassari",SV:"Savona",TA:"Taranto",TE:"Teramo",TN:"Trento",TO:"Torino",TP:"Trapani",TR:"Terni",TS:"Trieste",TV:"Treviso",UD:"Udine",VA:"Varese",VB:"Verbano-Cusio-Ossola",VC:"Vercelli",VE:"Venezia",VI:"Vicenza",VR:"Verona",VS:"Medio Campidano",VT:"Viterbo",VV:"Vibo Valentia"}},JP:{label:"Prefectures",areas:{Hokkaido:"Hokkaido",Aomori:"Aomori",Iwate:"Iwate",Miyagi:"Miyagi",Akita:"Akita",Yamagata:"Yamagata",Fukushima:"Fukushima",Ibaraki:"Ibaraki",Tochigi:"Tochigi",Gunma:"Gunma",Saitama:"Saitama",Chiba:"Chiba",Tokyo:"Tokyo",Kanagawa:"Kanagawa",Niigata:"Niigata",Toyama:"Toyama",Ishikawa:"Ishikawa",Fukui:"Fukui",Yamanashi:"Yamanashi",Nagano:"Nagano",Gifu:"Gifu",Shizuoka:"Shizuoka",Aichi:"Aichi",Mie:"Mie",Shiga:"Shiga",Kyoto:"Kyoto",Osaka:"Osaka",Hyogo:"Hyogo",Nara:"Nara",Wakayama:"Wakayama",Tottori:"Tottori",Shimane:"Shimane",Okayama:"Okayama",Hiroshima:"Hiroshima",Yamaguchi:"Yamaguchi",Tokushima:"Tokushima",Kagawa:"Kagawa",Ehime:"Ehime",Kochi:"Kochi",Fukuoka:"Fukuoka",Saga:"Saga",Nagasaki:"Nagasaki",Kumamoto:"Kumamoto",Oita:"Oita",Miyazaki:"Miyazaki",Kagoshima:"Kagoshima",Okinawa:"Okinawa"}},MY:{label:"States",areas:{Johor:"Johor",Kedah:"Kedah",Kelantan:"Kelantan","Kuala Lumpur":"Kuala Lumpur",Labuan:"Labuan",Melaka:"Melaka","Negeri Sembilan":"Negeri Sembilan",Pahang:"Pahang",Perak:"Perak",Perlis:"Perlis","Pulau Pinang":"Pulau Pinang",Putrajaya:"Putrajaya",Sabah:"Sabah",Sarawak:"Sarawak",Selangor:"Selangor",Terengganu:"Terengganu"}},MX:{label:"States",areas:{AGU:"Aguascalientes",BCN:"Baja California",BCS:"Baja California Sur",CAM:"Campeche",COA:"Coahuila",COL:"Colima",CHP:"Chiapas",CHH:"Chihuahua",DIF:"Distrito Federal",DUG:"Durango",MEX:"Estado de MÃ©xico",GUA:"Guanajuato",GRO:"Guerrero",HID:"Hidalgo",JAL:"Jalisco",MIC:"MichoacÃ¡n",MOR:"Morelos",NAY:"Nayarit",NLE:"Nuevo LeÃ³n",OAX:"Oaxaca",PUE:"Puebla",QUE:"Queretaro",ROO:"Quintana Roo",SLP:"San Luis PotosÃ­",SIN:"Sinaloa",SON:"Sonora",TAB:"Tabasco",TAM:"Tamaulipas",TLA:"Tlaxcala",VER:"Veracruz",YUC:"YucatÃ¡n",ZAC:"Zacatecas"}},NZ:{label:"Regions",areas:{AUK:"Auckland",BOP:"Bay of Plenty",CAN:"Canterbury",HKB:"Hawke's Bay",MWT:"Manawatu-Wanganui",NTL:"Northland",OTA:"Otago",STL:"Southland",TKI:"Taranaki",WKO:"Waikato",WGN:"Wellington",WTC:"West Coast",GIS:"Gisborne District",MBH:"Marlborough District",NSN:"Nelson",TAS:"Tasman District",CIT:"Chatham Islands Territory"}},PE:{label:"Regions",areas:{AMA:"Amazonas",ANC:"Ancash",APU:"Apurimac",ARE:"Arequipa",AYA:"Ayacucho",CAJ:"Cajamarca",CAL:"Callao",CUS:"Cusco",HUV:"Huancavelica",HUC:"Huanuco",ICA:"Ica",JUN:"Junin",LAL:"La Libertad",LAM:"Lambayeque",LIM:"Lima",LOR:"Loreto",MDD:"Madre de Dios",MOQ:"Moquegua",PAS:"Pasco",PIU:"Piura",PUN:"Puno",SAM:"San Martin",TAC:"Tacna",TUM:"Tumbes",UCA:"Ucayali"}},RU:{label:"Regions",areas:{MOW:"Moskva",SPE:"Sankt-Peterburg",AD:"Adygeya, Respublika",AL:"Altay, Respublika",BA:"Bashkortostan, Respublika",BU:"Buryatiya, Respublika",CE:"Chechenskaya Respublika",CU:"Chuvashskaya Respublika",DA:"Dagestan, Respublika",IN:"Ingushetiya, Respublika",KB:"Kabardino-Balkarskaya Respublika",KL:"Kalmykiya, Respublika",KC:"Karachayevo-Cherkesskaya Respublika",KR:"Kareliya, Respublika",KK:"Khakasiya, Respublika",KO:"Komi, Respublika",ME:"Mariy El, Respublika",MO:"Mordoviya, Respublika",SA:"Sakha, Respublika [Yakutiya]",SE:"Severnaya Osetiya-Alaniya, Respublika",TA:"Tatarstan, Respublika",TY:"Tyva, Respublika [Tuva]",UD:"Udmurtskaya Respublika",ALT:"Altayskiy kray",KAM:"Kamchatskiy kray",KHA:"Khabarovskiy kray",KDA:"Krasnodarskiy kray",KYA:"Krasnoyarskiy kray",PER:"Permskiy kray",PRI:"Primorskiy kray",STA:"Stavropolskiy kray",ZAB:"Zabaykalskiy kray",AMU:"Amurskaya oblast",ARK:"Arkhangelskaya oblast",AST:"Astrakhanskaya oblast",BEL:"Belgorodskaya oblast",BRY:"Bryanskaya oblast",CHE:"Chelyabinskaya oblast",IRK:"Irkutskaya oblast",IVA:"Ivanovskaya oblast",KGD:"Kaliningradskaya oblast",KLU:"Kaluzhskaya oblast",KEM:"Kemerovskaya oblast",KIR:"Kirovskaya oblast",KOS:"Kostromskaya oblast",KGN:"Kurganskaya oblast",KRS:"Kurskaya oblast",LEN:"Leningradskaya oblast",LIP:"Lipetskaya oblast",MAG:"Magadanskaya oblast",MOS:"Moskovskaya oblast",MUR:"Murmanskaya oblast",NIZ:"Nizhegorodskaya oblast",NGR:"Novgorodskaya oblast",NVS:"Novosibirskaya oblast",OMS:"Omskaya oblast",ORE:"Orenburgskaya oblast",ORL:"Orlovskaya oblast",PNZ:"Penzenskaya oblast",PSK:"Pskovskaya oblast",ROS:"Rostovskaya oblast",RYA:"Ryazanskaya oblast",SAK:"Sakhalinskaya oblast",SAM:"Samarskaya oblast",SAR:"Saratovskaya oblast",SMO:"Smolenskaya oblast",SVE:"Sverdlovskaya oblast",TAM:"Tambovskaya oblast",TOM:"Tomskaya oblast",TUL:"Tulskaya oblast",TVE:"Tverskaya oblast",TYU:"Tyumenskaya oblast",ULY:"Ulyanovskaya oblast",VLA:"Vladimirskaya oblast",VGG:"Volgogradskaya oblast",VLG:"Vologodskaya oblast",VOR:"Voronezhskaya oblast",YAR:"Yaroslavskaya oblast",YEV:"Yevreyskaya avtonomnaya oblast",CHU:"Chukotskiy avtonomnyy okrug",KHM:"Khanty-Mansiyskiy avtonomnyy okrug-Yugra",NEN:"Nenetskiy avtonomnyy okrug",YAN:"Yamalo-Nenetskiy avtonomnyy okrug"}},ZA:{label:"Provinces",areas:{"Eastern Cape":"Eastern Cape","Free State":"Free State",Gauteng:"Gauteng","KwaZulu-Natal":"KwaZulu-Natal",Limpopo:"Limpopo",Mpumalanga:"Mpumalanga","North West":"North West","Northern Cape":"Northern Cape","Western Cape":"Western Cape"}},KR:{label:"Provinces",areas:{Seoul:"Seoul",Busan:"Busan",Daegu:"Daegu",Daejeon:"Daejeon",Gwangju:"Gwangju",Incheon:"Incheon",Ulsan:"Ulsan","Chungcheongbuk-do":"Chungcheongbuk-do","Chungcheongnam-do":"Chungcheongnam-do","Gangwon-do":"Gangwon-do","Gyeonggi-do":"Gyeonggi-do","Gyeongsangbuk-do":"Gyeongsangbuk-do","Gyeongsangnam-do":"Gyeongsangnam-do","Jeju-do":"Jeju-do","Jeollabuk-do":"Jeollabuk-do","Jeollanam-do":"Jeollanam-do",Sejong:"Sejong"}},ES:{label:"Provinces",areas:{C:"A CoruÃ±a",VI:"Alava",AB:"Albacete",A:"Alicante",AL:"AlmerÃ­a",O:"Asturias",AV:"Ãvila",BA:"Badajoz",PM:"Baleares",B:"Barcelona",BU:"Burgos",CC:"CÃ¡ceres",CA:"CÃ¡diz",S:"Cantabria",CS:"CastellÃ³n",CE:"Ceuta",CR:"Ciudad Real",CO:"CÃ³rdoba",CU:"Cuenca",GI:"Gerona",GR:"Granada",GU:"Guadalajara",SS:"GuipÃºzcoa",H:"Huelva",HU:"Huesca",J:"JaÃ©n",LO:"La Rioja",GC:"Las Palmas",LE:"LeÃ³n",L:"LÃ©rida",LU:"Lugo",M:"Madrid",MA:"MÃ¡laga",ML:"Melilla",MU:"Murcia",NA:"Navarra",OR:"Ourense",P:"Palencia",PO:"Pontevedra",SA:"Salamanca",TF:"Santa Cruz de Tenerife",SG:"Segovia",SE:"Sevilla",SO:"Soria",T:"Tarragona",TE:"Teruel",TO:"Toledo",V:"Valencia",VA:"Valladolid",BI:"Vizcaya",ZA:"Zamora",Z:"Zaragoza"}},AE:{label:"Emirates",areas:{AZ:"Abu Dhabi",FU:"Fujairah",UQ:"Umm al-Quwain",SH:"Sharjah",DU:"Dubai",RK:"Ras al-Khaimah",AJ:"AjmÄn"}},US:{label:"States",areas:{AL:"Alabama",AK:"Alaska",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",DC:"District Of Columbia",FL:"Florida",GA:"Georgia",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PA:"Pennsylvania",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming",AA:"Armed Forces (Americas)",AE:"Armed Forces (Europe, Canada, Middle East, Africa)",AP:"Armed Forces (Pacific)",AS:"American Samoa",FM:"Federated States of Micronesia",GU:"Guam",MH:"Marshall Islands",MP:"Northern Mariana Islands",PW:"Palau",PR:"Puerto Rico",VI:"Virgin Islands"}}},c=_.reduce({AF:["Afghanistan","AS","AFN",["ps","uz","tk"],"ðŸ‡¦ðŸ‡«"],AX:["Ã…land","EU","EUR",["sv"],"ðŸ‡¦ðŸ‡½"],AL:["Albania","EU","ALL",["sq"],"ðŸ‡¦ðŸ‡±"],DZ:["Algeria","AF","DZD",["ar"],"ðŸ‡©ðŸ‡¿"],AS:["American Samoa","OC","USD",["en","sm"],"ðŸ‡¦ðŸ‡¸"],AD:["Andorra","EU","EUR",["ca"],"ðŸ‡¦ðŸ‡©"],AO:["Angola","AF","AOA",["pt"],"ðŸ‡¦ðŸ‡´"],AI:["Anguilla","NA","XCD",["en"],"ðŸ‡¦ðŸ‡®"],AQ:["Antarctica","AN","",[],"ðŸ‡¦ðŸ‡¶"],AG:["Antigua and Barbuda","NA","XCD",["en"],"ðŸ‡¦ðŸ‡¬"],AR:["Argentina","SA","ARS",["es","gn"],"ðŸ‡¦ðŸ‡·"],AM:["Armenia","AS","AMD",["hy","ru"],"ðŸ‡¦ðŸ‡²"],AW:["Aruba","NA","AWG",["nl","pa"],"ðŸ‡¦ðŸ‡¼"],AU:["Australia","OC","AUD",["en"],"ðŸ‡¦ðŸ‡º"],AT:["Austria","EU","EUR",["de"],"ðŸ‡¦ðŸ‡¹"],AZ:["Azerbaijan","AS","AZN",["az"],"ðŸ‡¦ðŸ‡¿"],BS:["Bahamas","NA","BSD",["en"],"ðŸ‡§ðŸ‡¸"],BH:["Bahrain","AS","BHD",["ar"],"ðŸ‡§ðŸ‡­"],BD:["Bangladesh","AS","BDT",["bn"],"ðŸ‡§ðŸ‡©"],BB:["Barbados","NA","BBD",["en"],"ðŸ‡§ðŸ‡§"],BY:["Belarus","EU","BYR",["be","ru"],"ðŸ‡§ðŸ‡¾"],BE:["Belgium","EU","EUR",["nl","fr"],"ðŸ‡§ðŸ‡ª"],BZ:["Belize","NA","BZD",["en","es"],"ðŸ‡§ðŸ‡¿"],BJ:["Benin","AF","XOF",["fr"],"ðŸ‡§ðŸ‡¯"],BM:["Bermuda","NA","BMD",["en"],"ðŸ‡§ðŸ‡²"],BT:["Bhutan","AS","BTN,INR",["dz"],"ðŸ‡§ðŸ‡¹"],BO:["Bolivia","SA","BOB,BOV",["es","ay","qu"],"ðŸ‡§ðŸ‡´"],BA:["Bosnia and Herzegovina","EU","BAM",["bs","hr","sr"],"ðŸ‡§ðŸ‡¦"],BW:["Botswana","AF","BWP",["en","tn"],"ðŸ‡§ðŸ‡¼"],BV:["Bouvet Island","AN","NOK",["no","nb","nn"],"ðŸ‡§ðŸ‡»"],BR:["Brazil","SA","BRL",["pt"],"ðŸ‡§ðŸ‡·"],IO:["British Indian Ocean Territory","AS","USD",["en"],"ðŸ‡®ðŸ‡´"],VG:["British Virgin Islands","NA","USD",["en"],"ðŸ‡»ðŸ‡¬"],BN:["Brunei","AS","BND",["ms"],"ðŸ‡§ðŸ‡³"],BG:["Bulgaria","EU","BGN",["bg"],"ðŸ‡§ðŸ‡¬"],BF:["Burkina Faso","AF","XOF",["fr","ff"],"ðŸ‡§ðŸ‡«"],BI:["Burundi","AF","BIF",["fr","rn"],"ðŸ‡§ðŸ‡®"],KH:["Cambodia","AS","KHR",["km"],"ðŸ‡°ðŸ‡­"],CM:["Cameroon","AF","XAF",["en","fr"],"ðŸ‡¨ðŸ‡²"],CA:["Canada","NA","CAD",["en","fr"],"ðŸ‡¨ðŸ‡¦"],CV:["Cape Verde","AF","CVE",["pt"],"ðŸ‡¨ðŸ‡»"],KY:["Cayman Islands","NA","KYD",["en"],"ðŸ‡°ðŸ‡¾"],CF:["Central African Republic","AF","XAF",["fr","sg"],"ðŸ‡¨ðŸ‡«"],TD:["Chad","AF","XAF",["fr","ar"],"ðŸ‡¹ðŸ‡©"],CL:["Chile","SA","CLF,CLP",["es"],"ðŸ‡¨ðŸ‡±"],CN:["China","AS","CNY",["zh"],"ðŸ‡¨ðŸ‡³"],CX:["Christmas Island","AS","AUD",["en"],"ðŸ‡¨ðŸ‡½"],CC:["Cocos [Keeling] Islands","AS","AUD",["en"],"ðŸ‡¨ðŸ‡¨"],CO:["Colombia","SA","COP",["es"],"ðŸ‡¨ðŸ‡´"],KM:["Comoros","AF","KMF",["ar","fr"],"ðŸ‡°ðŸ‡²"],CG:["Republic of the Congo","AF","XAF",["fr","ln"],"ðŸ‡¨ðŸ‡¬"],CD:["Democratic Republic of the Congo","AF","CDF",["fr","ln","kg","sw","lu"],"ðŸ‡¨ðŸ‡©"],CK:["Cook Islands","OC","NZD",["en"],"ðŸ‡¨ðŸ‡°"],CR:["Costa Rica","NA","CRC",["es"],"ðŸ‡¨ðŸ‡·"],CU:["Cuba","NA","CUC,CUP",["es"],"ðŸ‡¨ðŸ‡º"],HR:["Croatia","EU","HRK",["hr"],"ðŸ‡­ðŸ‡·"],CW:["Curacao","NA","ANG",["nl","pa","en"],"ðŸ‡¨ðŸ‡¼"],CY:["Cyprus","EU","EUR",["el","tr","hy"],"ðŸ‡¨ðŸ‡¾"],CZ:["Czech Republic","EU","CZK",["cs","sk"],"ðŸ‡¨ðŸ‡¿"],DK:["Denmark","EU","DKK",["da"],"ðŸ‡©ðŸ‡°"],DJ:["Djibouti","AF","DJF",["fr","ar"],"ðŸ‡©ðŸ‡¯"],DM:["Dominica","NA","XCD",["en"],"ðŸ‡©ðŸ‡²"],DO:["Dominican Republic","NA","DOP",["es"],"ðŸ‡©ðŸ‡´"],EC:["Ecuador","SA","USD",["es"],"ðŸ‡ªðŸ‡¨"],EG:["Egypt","AF","EGP",["ar"],"ðŸ‡ªðŸ‡¬"],SV:["El Salvador","NA","SVC,USD",["es"],"ðŸ‡¸ðŸ‡»"],GQ:["Equatorial Guinea","AF","XAF",["es","fr"],"ðŸ‡¬ðŸ‡¶"],ER:["Eritrea","AF","ERN",["ti","ar","en"],"ðŸ‡ªðŸ‡·"],EE:["Estonia","EU","EUR",["et"],"ðŸ‡ªðŸ‡ª"],ET:["Ethiopia","AF","ETB",["am"],"ðŸ‡ªðŸ‡¹"],FK:["Falkland Islands","SA","FKP",["en"],"ðŸ‡«ðŸ‡°"],FO:["Faroe Islands","EU","DKK",["fo"],"ðŸ‡«ðŸ‡´"],FJ:["Fiji","OC","FJD",["en","fj","hi","ur"],"ðŸ‡«ðŸ‡¯"],FI:["Finland","EU","EUR",["fi","sv"],"ðŸ‡«ðŸ‡®"],FR:["France","EU","EUR",["fr"],"ðŸ‡«ðŸ‡·"],GF:["French Guiana","SA","EUR",["fr"],"ðŸ‡¬ðŸ‡«"],PF:["French Polynesia","OC","XPF",["fr"],"ðŸ‡µðŸ‡«"],TF:["French Southern Territories","AN","EUR",["fr"],"ðŸ‡¹ðŸ‡«"],GA:["Gabon","AF","XAF",["fr"],"ðŸ‡¬ðŸ‡¦"],GM:["Gambia","AF","GMD",["en"],"ðŸ‡¬ðŸ‡²"],GE:["Georgia","AS","GEL",["ka"],"ðŸ‡¬ðŸ‡ª"],DE:["Germany","EU","EUR",["de"],"ðŸ‡©ðŸ‡ª"],GH:["Ghana","AF","GHS",["en"],"ðŸ‡¬ðŸ‡­"],GI:["Gibraltar","EU","GIP",["en"],"ðŸ‡¬ðŸ‡®"],GR:["Greece","EU","EUR",["el"],"ðŸ‡¬ðŸ‡·"],GL:["Greenland","NA","DKK",["kl"],"ðŸ‡¬ðŸ‡±"],GD:["Grenada","NA","XCD",["en"],"ðŸ‡¬ðŸ‡©"],GP:["Guadeloupe","NA","EUR",["fr"],"ðŸ‡¬ðŸ‡µ"],GU:["Guam","OC","USD",["en","ch","es"],"ðŸ‡¬ðŸ‡º"],GT:["Guatemala","NA","GTQ",["es"],"ðŸ‡¬ðŸ‡¹"],GG:["Guernsey","EU","GBP",["en","fr"],"ðŸ‡¬ðŸ‡¬"],GN:["Guinea","AF","GNF",["fr","ff"],"ðŸ‡¬ðŸ‡³"],GW:["Guinea-Bissau","AF","XOF",["pt"],"ðŸ‡¬ðŸ‡¼"],GY:["Guyana","SA","GYD",["en"],"ðŸ‡¬ðŸ‡¾"],HT:["Haiti","NA","HTG,USD",["fr","ht"],"ðŸ‡­ðŸ‡¹"],HM:["Heard Island and McDonald Islands","AN","AUD",["en"],"ðŸ‡­ðŸ‡²"],HN:["Honduras","NA","HNL",["es"],"ðŸ‡­ðŸ‡³"],HK:["Hong Kong","AS","HKD",["zh","en"],"ðŸ‡­ðŸ‡°"],HU:["Hungary","EU","HUF",["hu"],"ðŸ‡­ðŸ‡º"],IS:["Iceland","EU","ISK",["is"],"ðŸ‡®ðŸ‡¸"],IN:["India","AS","INR",["hi","en"],"ðŸ‡®ðŸ‡³"],ID:["Indonesia","AS","IDR",["id"],"ðŸ‡®ðŸ‡©"],IR:["Iran","AS","IRR",["fa"],"ðŸ‡®ðŸ‡·"],IQ:["Iraq","AS","IQD",["ar","ku"],"ðŸ‡®ðŸ‡¶"],IE:["Ireland","EU","EUR",["ga","en"],"ðŸ‡®ðŸ‡ª"],IM:["Isle of Man","EU","GBP",["en","gv"],"ðŸ‡®ðŸ‡²"],IL:["Israel","AS","ILS",["he","ar"],"ðŸ‡®ðŸ‡±"],IT:["Italy","EU","EUR",["it"],"ðŸ‡®ðŸ‡¹"],CI:["Ivory Coast","AF","XOF",["fr"],"ðŸ‡¨ðŸ‡®"],JM:["Jamaica","NA","JMD",["en"],"ðŸ‡¯ðŸ‡²"],JP:["Japan","AS","JPY",["ja"],"ðŸ‡¯ðŸ‡µ"],JE:["Jersey","EU","GBP",["en","fr"],"ðŸ‡¯ðŸ‡ª"],JO:["Jordan","AS","JOD",["ar"],"ðŸ‡¯ðŸ‡´"],KZ:["Kazakhstan","AS","KZT",["kk","ru"],"ðŸ‡°ðŸ‡¿"],KE:["Kenya","AF","KES",["en","sw"],"ðŸ‡°ðŸ‡ª"],KI:["Kiribati","OC","AUD",["en"],"ðŸ‡°ðŸ‡®"],XK:["Kosovo","EU","EUR",["sr","sq"],"ðŸ‡½ðŸ‡°"],KW:["Kuwait","AS","KWD",["ar"],"ðŸ‡°ðŸ‡¼"],KG:["Kyrgyzstan","AS","KGS",["ky","ru"],"ðŸ‡°ðŸ‡¬"],LA:["Laos","AS","LAK",["lo"],"ðŸ‡±ðŸ‡¦"],LV:["Latvia","EU","EUR",["lv"],"ðŸ‡±ðŸ‡»"],LB:["Lebanon","AS","LBP",["ar","fr"],"ðŸ‡±ðŸ‡§"],LS:["Lesotho","AF","LSL,ZAR",["en","st"],"ðŸ‡±ðŸ‡¸"],LR:["Liberia","AF","LRD",["en"],"ðŸ‡±ðŸ‡·"],LY:["Libya","AF","LYD",["ar"],"ðŸ‡±ðŸ‡¾"],LI:["Liechtenstein","EU","CHF",["de"],"ðŸ‡±ðŸ‡®"],LT:["Lithuania","EU","EUR",["lt"],"ðŸ‡±ðŸ‡¹"],LU:["Luxembourg","EU","EUR",["fr","de","lb"],"ðŸ‡±ðŸ‡º"],MO:["Macao","AS","MOP",["zh","pt"],"ðŸ‡²ðŸ‡´"],MK:["North Macedonia","EU","MKD",["mk"],"ðŸ‡²ðŸ‡°"],MG:["Madagascar","AF","MGA",["fr","mg"],"ðŸ‡²ðŸ‡¬"],MW:["Malawi","AF","MWK",["en","ny"],"ðŸ‡²ðŸ‡¼"],MY:["Malaysia","AS","MYR",["ms"],"ðŸ‡²ðŸ‡¾"],MV:["Maldives","AS","MVR",["dv"],"ðŸ‡²ðŸ‡»"],ML:["Mali","AF","XOF",["fr"],"ðŸ‡²ðŸ‡±"],MT:["Malta","EU","EUR",["mt","en"],"ðŸ‡²ðŸ‡¹"],MH:["Marshall Islands","OC","USD",["en","mh"],"ðŸ‡²ðŸ‡­"],MQ:["Martinique","NA","EUR",["fr"],"ðŸ‡²ðŸ‡¶"],MR:["Mauritania","AF","MRU",["ar"],"ðŸ‡²ðŸ‡·"],MU:["Mauritius","AF","MUR",["en"],"ðŸ‡²ðŸ‡º"],YT:["Mayotte","AF","EUR",["fr"],"ðŸ‡¾ðŸ‡¹"],MX:["Mexico","NA","MXN",["es"],"ðŸ‡²ðŸ‡½"],FM:["Micronesia","OC","USD",["en"],"ðŸ‡«ðŸ‡²"],MD:["Moldova","EU","MDL",["ro"],"ðŸ‡²ðŸ‡©"],MC:["Monaco","EU","EUR",["fr"],"ðŸ‡²ðŸ‡¨"],MN:["Mongolia","AS","MNT",["mn"],"ðŸ‡²ðŸ‡³"],ME:["Montenegro","EU","EUR",["sr","bs","sq","hr"],"ðŸ‡²ðŸ‡ª"],MS:["Montserrat","NA","XCD",["en"],"ðŸ‡²ðŸ‡¸"],MA:["Morocco","AF","MAD",["ar"],"ðŸ‡²ðŸ‡¦"],MZ:["Mozambique","AF","MZN",["pt"],"ðŸ‡²ðŸ‡¿"],MM:["Myanmar [Burma]","AS","MMK",["my"],"ðŸ‡²ðŸ‡²"],NA:["Namibia","AF","NAD,ZAR",["en","af"],"ðŸ‡³ðŸ‡¦"],NR:["Nauru","OC","AUD",["en","na"],"ðŸ‡³ðŸ‡·"],NP:["Nepal","AS","NPR",["ne"],"ðŸ‡³ðŸ‡µ"],NL:["Netherlands","EU","EUR",["nl"],"ðŸ‡³ðŸ‡±"],AN:["Netherlands Antilles","SA","ANG",["nl","en"],"ðŸ‡§ðŸ‡¶"],NC:["New Caledonia","OC","XPF",["fr"],"ðŸ‡³ðŸ‡¨"],NZ:["New Zealand","OC","NZD",["en","mi"],"ðŸ‡³ðŸ‡¿"],NI:["Nicaragua","NA","NIO",["es"],"ðŸ‡³ðŸ‡®"],NE:["Niger","AF","XOF",["fr"],"ðŸ‡³ðŸ‡ª"],NG:["Nigeria","AF","NGN",["en"],"ðŸ‡³ðŸ‡¬"],NU:["Niue","OC","NZD",["en"],"ðŸ‡³ðŸ‡º"],NF:["Norfolk Island","OC","AUD",["en"],"ðŸ‡³ðŸ‡«"],MP:["Northern Mariana Islands","OC","USD",["en","ch"],"ðŸ‡²ðŸ‡µ"],KP:["North Korea","AS","KPW",["ko"],"ðŸ‡°ðŸ‡µ"],NO:["Norway","EU","NOK",["no","nb","nn"],"ðŸ‡³ðŸ‡´"],OM:["Oman","AS","OMR",["ar"],"ðŸ‡´ðŸ‡²"],PK:["Pakistan","AS","PKR",["en","ur"],"ðŸ‡µðŸ‡°"],PW:["Palau","OC","USD",["en"],"ðŸ‡µðŸ‡¼"],PS:["Palestine","AS","ILS",["ar"],"ðŸ‡µðŸ‡¸"],PA:["Panama","NA","PAB,USD",["es"],"ðŸ‡µðŸ‡¦"],PG:["Papua New Guinea","OC","PGK",["en"],"ðŸ‡µðŸ‡¬"],PY:["Paraguay","SA","PYG",["es","gn"],"ðŸ‡µðŸ‡¾"],PE:["Peru","SA","PEN",["es"],"ðŸ‡µðŸ‡ª"],PH:["Philippines","AS","PHP",["en"],"ðŸ‡µðŸ‡­"],PN:["Pitcairn Islands","OC","NZD",["en"],"ðŸ‡µðŸ‡³"],PL:["Poland","EU","PLN",["pl"],"ðŸ‡µðŸ‡±"],PT:["Portugal","EU","EUR",["pt"],"ðŸ‡µðŸ‡¹"],PR:["Puerto Rico","NA","USD",["es","en"],"ðŸ‡µðŸ‡·"],QA:["Qatar","AS","QAR",["ar"],"ðŸ‡¶ðŸ‡¦"],RE:["RÃ©union","AF","EUR",["fr"],"ðŸ‡·ðŸ‡ª"],RO:["Romania","EU","RON",["ro"],"ðŸ‡·ðŸ‡´"],RU:["Russia","EU","RUB",["ru"],"ðŸ‡·ðŸ‡º"],RW:["Rwanda","AF","RWF",["rw","en","fr"],"ðŸ‡·ðŸ‡¼"],BL:["Saint BarthÃ©lemy","NA","EUR",["fr"],"ðŸ‡§ðŸ‡±"],SH:["Saint Helena","AF","SHP",["en"],"ðŸ‡¸ðŸ‡­"],KN:["Saint Kitts and Nevis","NA","XCD",["en"],"ðŸ‡°ðŸ‡³"],LC:["Saint Lucia","NA","XCD",["en"],"ðŸ‡±ðŸ‡¨"],MF:["Saint Martin","NA","EUR",["en","fr","nl"],"ðŸ‡²ðŸ‡«"],PM:["Saint Pierre and Miquelon","NA","EUR",["fr"],"ðŸ‡µðŸ‡²"],VC:["Saint Vincent and the Grenadines","NA","XCD",["en"],"ðŸ‡»ðŸ‡¨"],WS:["Samoa","OC","WST",["sm","en"],"ðŸ‡¼ðŸ‡¸"],SM:["San Marino","EU","EUR",["it"],"ðŸ‡¸ðŸ‡²"],ST:["SÃ£o TomÃ© and PrÃ­ncipe","AF","STN",["pt"],"ðŸ‡¸ðŸ‡¹"],SA:["Saudi Arabia","AS","SAR",["ar"],"ðŸ‡¸ðŸ‡¦"],SN:["Senegal","AF","XOF",["fr"],"ðŸ‡¸ðŸ‡³"],RS:["Serbia","EU","RSD",["sr"],"ðŸ‡·ðŸ‡¸"],SC:["Seychelles","AF","SCR",["fr","en"],"ðŸ‡¸ðŸ‡¨"],SL:["Sierra Leone","AF","SLL",["en"],"ðŸ‡¸ðŸ‡±"],SG:["Singapore","AS","SGD",["en","ms","ta","zh"],"ðŸ‡¸ðŸ‡¬"],SK:["Slovakia","EU","EUR",["sk"],"ðŸ‡¸ðŸ‡°"],SI:["Slovenia","EU","EUR",["sl"],"ðŸ‡¸ðŸ‡®"],SB:["Solomon Islands","OC","SBD",["en"],"ðŸ‡¸ðŸ‡§"],SO:["Somalia","AF","SOS",["so","ar"],"ðŸ‡¸ðŸ‡´"],ZA:["South Africa","AF","ZAR",["af","en","nr","st","ss","tn","ts","ve","xh","zu"],"ðŸ‡¿ðŸ‡¦"],GS:["South Georgia and the South Sandwich Islands","AN","GBP",["en"],"ðŸ‡¬ðŸ‡¸"],KR:["South Korea","AS","KRW",["ko"],"ðŸ‡°ðŸ‡·"],ES:["Spain","EU","EUR",["es","eu","ca","gl","oc"],"ðŸ‡ªðŸ‡¸"],LK:["Sri Lanka","AS","LKR",["si","ta"],"ðŸ‡±ðŸ‡°"],SD:["Sudan","AF","SDG",["ar","en"],"ðŸ‡¸ðŸ‡©"],SR:["Suriname","SA","SRD",["nl"],"ðŸ‡¸ðŸ‡·"],SJ:["Svalbard and Jan Mayen","EU","NOK",["no"],"ðŸ‡¸ðŸ‡¯"],SZ:["Swaziland","AF","SZL",["en","ss"],"ðŸ‡¸ðŸ‡¿"],SE:["Sweden","EU","SEK",["sv"],"ðŸ‡¸ðŸ‡ª"],CH:["Switzerland","EU","CHE,CHF,CHW",["de","fr","it"],"ðŸ‡¨ðŸ‡­"],SY:["Syria","AS","SYP",["ar"],"ðŸ‡¸ðŸ‡¾"],TW:["Taiwan","AS","TWD",["zh"],"ðŸ‡¹ðŸ‡¼"],TJ:["Tajikistan","AS","TJS",["tg","ru"],"ðŸ‡¹ðŸ‡¯"],TZ:["Tanzania","AF","TZS",["sw","en"],"ðŸ‡¹ðŸ‡¿"],TH:["Thailand","AS","THB",["th"],"ðŸ‡¹ðŸ‡­"],TL:["East Timor","OC","USD",["pt"],"ðŸ‡¹ðŸ‡±"],TG:["Togo","AF","XOF",["fr"],"ðŸ‡¹ðŸ‡¬"],TK:["Tokelau","OC","NZD",["en"],"ðŸ‡¹ðŸ‡°"],TO:["Tonga","OC","TOP",["en","to"],"ðŸ‡¹ðŸ‡´"],TT:["Trinidad and Tobago","NA","TTD",["en"],"ðŸ‡¹ðŸ‡¹"],TN:["Tunisia","AF","TND",["ar"],"ðŸ‡¹ðŸ‡³"],TR:["Turkey","AS","TRY",["tr"],"ðŸ‡¹ðŸ‡·"],TM:["Turkmenistan","AS","TMT",["tk","ru"],"ðŸ‡¹ðŸ‡²"],TC:["Turks and Caicos Islands","NA","USD",["en"],"ðŸ‡¹ðŸ‡¨"],TV:["Tuvalu","OC","AUD",["en"],"ðŸ‡¹ðŸ‡»"],VI:["U.S. Virgin Islands","NA","USD",["en"],"ðŸ‡»ðŸ‡®"],UG:["Uganda","AF","UGX",["en","sw"],"ðŸ‡ºðŸ‡¬"],UA:["Ukraine","EU","UAH",["uk"],"ðŸ‡ºðŸ‡¦"],AE:["United Arab Emirates","AS","AED",["ar"],"ðŸ‡¦ðŸ‡ª"],GB:["United Kingdom","EU","GBP",["en"],"ðŸ‡¬ðŸ‡§"],US:["United States","NA","USD,USN,USS",["en"],"ðŸ‡ºðŸ‡¸"],UM:["U.S. Minor Outlying Islands","OC","USD",["en"],"ðŸ‡ºðŸ‡²"],UY:["Uruguay","SA","UYI,UYU",["es"],"ðŸ‡ºðŸ‡¾"],UZ:["Uzbekistan","AS","UZS",["uz","ru"],"ðŸ‡ºðŸ‡¿"],VU:["Vanuatu","OC","VUV",["bi","en","fr"],"ðŸ‡»ðŸ‡º"],VA:["Vatican City","EU","EUR",["it","la"],"ðŸ‡»ðŸ‡¦"],VE:["Venezuela","SA","VES",["es"],"ðŸ‡»ðŸ‡ª"],VN:["Vietnam","AS","VND",["vi"],"ðŸ‡»ðŸ‡³"],WF:["Wallis and Futuna","OC","XPF",["fr"],"ðŸ‡¼ðŸ‡«"],EH:["Western Sahara","AF","MAD,DZD,MRU",["es"],"ðŸ‡ªðŸ‡­"],YE:["Yemen","AS","YER",["ar"],"ðŸ‡¾ðŸ‡ª"],ZM:["Zambia","AF","ZMK",["en"],"ðŸ‡¿ðŸ‡²"],ZW:["Zimbabwe","AF","USD,ZAR,BWP,GBP,AUD,CNY,INR,JPY",["en","sn","nd"],"ðŸ‡¿ðŸ‡¼"]},function(e,t,a){return e[a]=_.object(s,t),e[a].continent=l[e[a].continent],e[a].ISOCode=a,d.hasOwnProperty(a)&&(e[a].administrativeAreas=d[a]),e},{}),u={getSupportedCurrencies:_.memoize(function(){return _.reduce(a,function(e,t){return e[t]={symbol:this.getSymbolForCurrencyCode(t),name:this.getNameForCurrencyCode(t)},e}.bind(this),{})}),getCountriesByContinent:_.memoize(function(){return _.reduce(c,function(e,t,a){return e[t.continent]||(e[t.continent]={}),e[t.continent][a]=t,e}.bind(this),{})}),getContinentMap:function(){return l},getLanguagesForCountry:function(e){var t=c[e];return t&&t.languages&&t.languages.length>0?t.languages:[]},getSymbolForCurrencyCode:function(e){return i.hasOwnProperty(e)?i[e]:e},getNameForCurrencyCode:function(e){return r.hasOwnProperty(e)?r[e]:e},getNameForLanguageCode:function(e){return o.hasOwnProperty(e)?o[e]:e},getCountryMap:function(){return c},getAdministrativeAreaMap:function(){return d},getStoreCurrency:function(){return e.get("currency")},getStoreCurrencySymbol:function(){return this.getSymbolForCurrencyCode(this.getStoreCurrency())},convertFractionalAmountToMainCurrencyUnit:function(e,t){return t||(t=this.getStoreCurrency()),n.includes(t)||(e/=100),e},convertMainCurrencyAmountToFractionalUnit:function(a){return t(a,{precision:n.includes(e.get("currency"))?0:2}).intValue},formatPriceForCurrency:function(t,a){var n;if(a||(a=this.getStoreCurrency()),t=this.convertFractionalAmountToMainCurrencyUnit(t,a),"string"!=typeof a?n=t+"":(a=a.toUpperCase(),n="undefined"!=typeof Intl?new Intl.NumberFormat(e.get("locale")||"en-US",{style:"currency",currency:a,currencyDisplay:"symbol",useGrouping:!0,minimumFractionDigits:0}).format(t):this.getSymbolForCurrencyCode(a)+" "+t.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")),"string"==typeof n&&-1!==n.indexOf(".")){var i=n.split(".");2===i.length&&1===i[1].length&&(i[1]=i[1]+"0",n=i.join("."))}return n},convertInputToCurrencyField:function(a,i,r){function o(a){var i=t(Math.max(a.value,0),{precision:n.includes(e.get("currency"))?0:2});0===i.intValue?a.value="":a.value!==i.toString()&&(a.value=i.value.toString())}a.addEventListener("input",function(a){if(r){var i=t(Math.max(a.currentTarget.value,0),{precision:n.includes(e.get("currency"))?0:2});r(i.intValue)}}.bind(this)),void 0!==i&&(a.value=this.convertFractionalAmountToMainCurrencyUnit(i),o(a)),a.addEventListener("change",function(e){o(e.currentTarget)}.bind(this))},convertInputToPercentageField:function(e,a,n){function i(e){var a=t(Math.min(Math.max(e.value,0),100),{precision:2});0===a.intValue?e.value="":e.value!==a.toString()&&(e.value=a.value.toString())}e.addEventListener("input",function(e){if(n){var a=t(Math.min(Math.max(e.currentTarget.value,0),100),{precision:2});n(a.intValue)}}.bind(this)),void 0!==a&&(e.value=a/100,i(e)),e.addEventListener("change",function(e){i(e.currentTarget)}.bind(this))}};return _.bindAll.apply(void 0,[u].concat(_.keys(u))),u}),define("ecommerce/views/client/widget",["ecommerce/models/shop","text!ecommerce/templates/client/widget.html","ecommerce/helpers"],function(e,t,a){return Backbone.View.extend({template:_.template(t),outOfStockMessage:"Out of Stock",events:{mousedown:"onMouseDown","click [data-add-to-cart]":"addToCart","change select[variant-option]":"updateCurrentSelectedVariant","change select[variant-list]":"updateCurrentSelectedVariant"},initialize:function(){this.defaults={mergevariantdropdowns:!1},this.listenTo(this.model,"sync change:attributes",this.render),this.listenTo(e,"change:locale change:currency",this.render),this.listenTo(this.model,"change:variants",_.debounce(function(e,t,a){!1!==a.render_changes&&this.render()},250)),this.listenTo(this.model,"destroy",function(){this.model=void 0,this.render()})},render:function(){return this.el.innerHTML=this.template({product:this.model,options:this.getOptions()}),this.updateCurrentSelectedVariant(),this.el.setAttribute("contenteditable",!1),this},updateCurrentSelectedVariant:function(){if(this.model){var e=this.getCurrentConfiguredVariant();if(!e)return this.el.querySelector(".product_price").textContent="â€‹",void(this.el.querySelector("[data-add-to-cart]").textContent="Unavailable");e&&this.el.querySelector(".product_price")&&(this.el.querySelector(".product_price").textContent=a.formatPriceForCurrency(e.get("price")));var t=this.el.querySelector("[data-add-to-cart]");if(this.model.get("is_available")&&e&&e.get("is_available")){var n=this.getOptions(),i=n.buttonText&&""!==n.buttonText?n.buttonText:"Add to Cart";null!==e.get("inventory")&&e.get("inventory")<=0?(i=this.outOfStockMessage,t.classList.add("out-of-stock")):t.classList.remove("out-of-stock"),t.textContent=i}else t.textContent="Unavailable"}},getCurrentConfiguredVariant:function(){if(this.model){if(this.model.get("use_default_variant"))return this.model.variantCollection.first();if(this.getOptions().mergevariantdropdowns){var e=this.el.querySelector("select[variant-list]").value;return this.model.variantCollection.get(e)}var t=_.reduce(this.el.querySelectorAll("select[variant-option]"),function(e,t){return e[_.escape(t.getAttribute("variant-option"))]=_.escape(t.value),e},{});return this.model.variantCollection.filter(function(e){return _.isEqual(e.get("attributes"),t)})[0]}},addToCart:function(){Cargo.Helper.IsAdminEdit()||(productToAdd=this.getCurrentConfiguredVariant(),productToAdd?this.model.get("is_available")&&productToAdd.get("is_available")?null!==productToAdd.get("inventory")&&productToAdd.get("inventory")<=0||void 0!==Cargo.Ecommerce.Collection.cart.add(productToAdd)&&Cargo.Event.trigger("add_history","cart"):Cargo.Modal.Alert({selector:"html",message:"This product is unavailable"}):Cargo.Modal.Alert({selector:"html",message:"Item not found."}))},getOptions:function(){var e={};if(this.el.hasAttribute("data-options"))try{e=JSON.parse(this.el.getAttribute("data-options"))}catch(e){}return _.defaults(e,this.defaults)},updateOptions:function(e){if(e){var t=this.getOptions();t=_.extend(t,e);try{this.el.setAttribute("data-options",JSON.stringify(t))}catch(e){console.warn("unable to store widget settings",e)}return this.render(),t}},startDrag:function(e){var t=CargoEditor.getActiveEditor(),a=document.createElement("style");a.innerText=".image-gallery, .image-gallery * { pointer-events:none!important} body, body * { cursor: default!important;}";t&&(document.body.appendChild(a),CargoEditor.events.trigger("editor-fake-dragstart",t,e,this.el,{useDragGhost:!0,useDragItemAsGhost:!0}),CargoEditor.events.once("editor-fake-dragend",function(e){document.body.removeChild(a)}))},onMouseDown:function(e){if(2!==e.button&&Cargo.Helper.IsAdminEdit()&&"SELECT"!==e.target.tagName&&"A"!==e.target.tagName){var t=e.clientX,a=e.clientY,n=_.bind(function(e){var r=t-e.clientX,o=a-e.clientY;Math.sqrt(r*r+o*o)>5&&(this.startDrag(e),window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",i))},this),i=function(){window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",i)};window.addEventListener("mousemove",n),window.addEventListener("mouseup",i)}}})}),requirejs.config({paths:{ecommerce:"/_jsapps/ecommerce-v2",global_libs:"/_jsapps/_libs"}}),define("ecommerce-client",["ecommerce/collections/products","ecommerce/collections/cart","ecommerce/models/shop","ecommerce/views/client/widget"],function(e,t,a,n){"undefined"==typeof Cargo&&(Cargo={}),Cargo.Ecommerce=Cargo.Ecommerce||{},Cargo.Ecommerce.Model=Cargo.Ecommerce.Model||{},Cargo.Ecommerce.Collection=Cargo.Ecommerce.Collection||{},Cargo.Ecommerce.Model.shop=a,Cargo.Ecommerce.Collection.products=new e,Cargo.Ecommerce.Collection.cart=new t,Cargo.Ecommerce.initWidgets=function(e,t){e=e||document.body;var a=[];_.each(e.querySelectorAll("shop"),function(e){if(e&&e.nodeType===Node.ELEMENT_NODE){var t=e.getAttribute("product");void 0!==t&&""!==t&&(e.hasAttribute("data-v1")&&(t=void 0),a.push({el:e,productId:t}))}}),_.each(e.querySelectorAll("a[data-variant]"),e=>{e.hasAttribute("data-product")&&a.push({productId:e.getAttribute("data-product")})}),a.length>0?Cargo.Ecommerce.Collection.products.fetchMultiple(_.without(_.pluck(a,"productId"),void 0),{always:function(){var e;_.each(a,function(t){t.el&&(e=Cargo.Ecommerce.Collection.products.get(t.productId),function(e,t){if(!e.__ecommerce_view__||e.__ecommerce_view__.model!==t){var a=new n({model:t});e.innerHTML="",a.setElement(e),a.render(),e.__ecommerce_view__=a}}(t.el,e))}),"function"==typeof t&&t()}.bind(this)}):"function"==typeof t&&t()},Cargo.Ecommerce.loadStripeAPI=function(){return new Promise(function(e,t){if("string"==typeof a.get("stripe_public_key")){var n=Cargo.View.Following.contentWindow.document,i=n.createElement("script"),r="https://js.stripe.com/v3/";n.querySelector('script[src="'+r+'"]')?e():(i.onload=function(){e()},i.onerror=function(){t("Unable to load Stripe SDK...")},i.setAttribute("src",r),n.head.appendChild(i))}else t(new Error("not setup"))}.bind(this))},Cargo.Ecommerce.loadPayPalAPI=function(){return new Promise(function(e,t){if(!1!==a.get("has_paypal")&&"string"==typeof a.get("paypal_client_id")){var n=Cargo.View.Following.contentWindow.document,i=n.createElement("script"),r="https://www.paypal.com/sdk/js?client-id="+a.get("paypal_client_id")+"&disable-funding=credit&currency="+a.get("currency");n.querySelector('script[src="'+r+'"]')?e():(i.onload=function(){e()},i.onerror=function(){t("Unable to load PayPal SDK...")},i.setAttribute("src",r),n.head.appendChild(i))}else t(new Error("not setup"))}.bind(this))},Cargo.Ecommerce.initWidgets(),a.on("change:currency",function(){Cargo.Ecommerce.initWidgets()}),Cargo.Event.trigger("ecommerce-client-initialized"),Cargo.Ecommerce.Collection.cart.on("change update reset",function(){Cargo.Core.Ecommerce.updateCartText(),Cargo.Core.Ecommerce.updateInlineCartCounters()}),Cargo.Core.Ecommerce.updateCartText(),Cargo.Core.Ecommerce.updateInlineCartCounters()}),define("text!ecommerce/templates/client/cart.html",[],function(){return'<div class="overflow-auto position-cover cart-padding">\n\t\x3c!-- Main Close Button --\x3e\n\t<div data-close class="x flex-end pos-abs clickable">\n\t\t<div style="display: contents;">\n\t\t\t<svg width="17px" height="17px" viewBox="0 0 17 17" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n\t\t\t\t<g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" opacity="0.400000006">\n\t\t\t\t\t<g id="Group" transform="translate(1.000000, 1.000000)" stroke="#FFFFFF" stroke-width="2">\n\t\t\t\t\t\t<path d="M0,0 L15,15" id="Path-3"></path>\n\t\t\t\t\t\t<path d="M0,0 L15,15" id="Path-3" transform="translate(7.500000, 7.500000) rotate(-270.000000) translate(-7.500000, -7.500000) "></path>\n\t\t\t\t\t</g>\n\t\t\t\t</g>\n\t\t\t</svg>\n\t\t</div>\n\t</div>\n\n\t\x3c!-- List --\x3e\n\t<div class="flex flex-col color-white" style="min-height: calc(100% - 8rem);">\n\n\t\t<% if(collectShippingInformation) { %>\n\n\t\t\t<div class="pad-medium-small pad-left-reset pad-top-reset lh-1">\n\t\t\t\t<div class="type-size-big">\n\t\t\t\t\tYour Information\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div id="shipping_address" class="type-size-normal"></div> \n\n\t\t<% } else if(cart.length > 0) { %>\n\n\t\t\t<div class="pad-medium-small pad-left-reset pad-top-reset lh-1">\n\t\t\t\t<div class="no-select type-size-big">\n\t\t\t\t\tYour Cart\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class="group-vertical group color-white" data-item-list>\n\t\t\t\t<% \n\t\t\t\t\tvar total = 0;\n\n\t\t\t\t\t_.each(cart, function(cartItemModel){\n\t\t\t\t\t\tvar itemAttr = cartItemModel.variantModel.get(\'attributes\');\n\t\t\t\t\t\tvar hasAttributes = _.size(itemAttr) >= 1;\n\t\t\t\t\t\tvar quantity = cartItemModel.get(\'quantity\');\n\t\t\t\t\t\tvar itemPrice = cartItemModel.variantModel.get(\'price\') * quantity;\n\t\t\t\t\t\ttotal += itemPrice;\n\n\t\t\t\t%>\n\t\t\t\t\t<div class="group-vertical group" data-item="">\n\t\t\t\t\t\t<div class="row col col-full outline negative-margin-bottom">\n\n\t\t\t\t\t\t\t<div class="col tal <% if(hasAttributes){ %>multi-line pad-block-small<% } else { %>pad-small<% } %>">\n\t\t\t\t\t\t\t\t<%= cartItemModel.productModel.get(\'name\') %>\n\t\t\t\t\t\t\t\t<% if(hasAttributes){ %>\n\t\t\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t\t\t<span style="color: rgba(255,255,255,.4)">\n\t\t\t\t\t\t\t\t\t\t<%= _.values(cartItemModel.variantModel.get(\'attributes\')).join(\', \') %>\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<% } %>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class="col col-right" style="align-self: flex-start;">\n\t\t\t\t\t\t\t\t<div \n\t\t\t\t\t\t\t\t\tclass="col col-square close-square color-grey-medium clickable noselect"\n\t\t\t\t\t\t\t\t\tdata-remove=""\n\t\t\t\t\t\t\t\t\tdata-change="<%= cartItemModel.get(\'product_id\') + \',\' + cartItemModel.get(\'variant_id\') %>"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\x3c!-- delete button --\x3e\n\t\t\t\t\t\t\t\t\t<svg width="13" height="13" x="0px" y="0px" viewBox="0 0 13 13" style="enable-background:new 0 0 13 13;" >\n\t\t\t\t\t\t\t\t\t\t<g id="Page-1" stroke-width="1" fill="none" fill-rule="evenodd">\n\t\t\t\t\t\t\t\t\t\t\t<g id="Group" transform="translate(1.000000, 1.000000)" stroke="#FFFFFF" >\n\t\t\t\t\t\t\t\t\t\t\t\t<path id="Path-3" class="st1" d="M-0.2-0.2l11.5,11.5"/>\n\t\t\t\t\t\t\t\t\t\t\t\t<path id="Path-3_1_" class="st1" d="M11.2-0.2L-0.2,11.2"/>\n\t\t\t\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t\t\t</svg>\n\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="col col-full row group-horizontal outline">\n\n\t\t\t\t\t\t\t<div \n\t\t\t\t\t\t\t\tclass="text col-end negative-margin-top text pos-rel quantity-wrapper <% if (quantity >= 10) { %>outline<% } %>" \n\t\t\t\t\t\t\t\tstyle="<% if (quantity <= 9) { %>min-width: 50px;width:50px;<% } else { %>min-width: 100px; width: 100px;<% } %>"\n\t\t\t\t\t\t\t>\n\n\t\t\t\t\t\t\t\t<input data-change="<%= cartItemModel.get(\'product_id\') + \',\' + cartItemModel.get(\'variant_id\') %>" type="number" value="<%= cartItemModel.get(\'quantity\') %>" name="quantity" id="quantity" class="input-reset" pattern="\\d*">\n\n\t\t\t\t\t\t\t\t\x3c!-- <span data-text-measure=""><%= cartItemModel.get(\'quantity\') %></span> --\x3e\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\x3c!-- show dropdown when quantity is less than 10 --\x3e\n\t\t\t\t\t\t\t\t<% if (quantity <= 9) { %>\n\t\t\t\t\t\t\t\t\t<div class="arrow-select clickable faux_qty_open" style="cursor: pointer; width: 3rem;">\n\t\t\t\t\t\t\t\t\t   <svg class="pen" style="enable-background:new 0 0 40 40; width: 40px; height: 40px;">\n\t\t\t\t\t\t\t\t\t\t\t<polygon style="transform: translate(-15%,0);" fill="rgba(255,255,255,.85)" class="st0" points="14,17.5 20,23.5 26,17.5 25,16.5 20,21.5 15,16.5 "></polygon>\n\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<select data-change="<%= cartItemModel.get(\'product_id\') + \',\' + cartItemModel.get(\'variant_id\') %>" name="faux_qty_select" id="faux_qty_select" class="pos-abs top-0 right-0 bottom-0" style="opacity: 0; width: 2rem; height: 100%; min-height: 4.2rem; cursor: pointer;">\n\n\t\t\t\t\t\t\t\t\t\t<% \n\t\t\t\t\t\t\t\t\t\tvar select_quantity = cartItemModel.get(\'quantity\');\n\t\t\t\t\t\t\t\t\t\t\tif( select_quantity >= 10 ){\n\t\t\t\t\t\t\t\t\t\t\t\tselect_quantity = 10;\n\t\t\t\t\t\t\t\t\t\t\t} \n\t\t\t\t\t\t\t\t\t\tfor (var i=1;i<=10; i++) { %>\n\t\t\t\t\t\t\t\t\t\t<option value="<%= i %>" <% if (select_quantity == i) { %>selected="selected"<% } %>>\n\t\t\t\t\t\t\t\t\t\t\t<%= i == 10 ? \'10+\' : i %>\n\t\t\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t\t\t\t<% }%>\n\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t<% } %>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class="col pad-small tar" data-price="">\n\t\t\t\t\t\t\t\t<%= formatPriceForCurrency(itemPrice) %>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t<% }); %>\n\t\t\t</div>\n\t\t\t\n\t\t\t<div class="row lh-1">\n\t\t\t<div class="col row color-white multi-line">\n\t\t\t\t\x3c!-- <div class="col lh-1">\n\t\t\t\t</div> --\x3e\n\t\t\t\t<div class="col tar lh-1 pad-small pad-left-reset pad-top-reset">\n\t\t\t\t\tSubtotal: <span data-total-price><%= formatPriceForCurrency(total) %></span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t</div>\n\n\t\t<% } else { %>\n\n\t\t\t<div class="pad-medium-small pad-left-reset pad-top-reset">\n\t\t\t\t<div class="col type-size-big">\n\t\t\t\t\tCart is Empty\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t<%}%>\n\n\t</div>\n\n\t<div class="row flex full-width full-width pad-y-medium pad-bottom-reset" data-following-footer>\n\n\t\t<% if(skipToCheckout) { %>\n\t\t\n\t\t\t<div data-next class="button-large col bg-blackest color-white tac clickable noselect flex outline pad-x-one-five pad-y-one tac display-block" style="font-size: 17px;">\n\t\t\t\t<div data-spinner class="psa"><%= Cargo.Core.Handlebars.Render( \'{{>loading_animation}}\', {extra_class: \'\'} ) %></div>\n\t\t\t\t<span class="type-bold">Update </span>\n\t\t\t\t<span class="large-arrow social-font">î‹ï¸Ž</span>\n\t\t\t</div>\n\n\t\t<% } else { %>\n\t\t\n\t\t\t<%\n\t\t\t\tif(collectShippingInformation) { \n\t\t\t%>\n\n\t\t\t<div class="col bg-blackest color-white tac clickable noselect flex outline col-square pad-x-one-five pad-y-one button-large" data-cancel-shipping style="flex:0.2;margin-right: 1.5rem; padding-left: 1.65rem; padding-right: 1.35rem;">\n\t\t\t\t<span class="large-arrow social-font">îŠï¸Ž</span>\n\t\t\t\t<div data-spinner class="psa"><%= Cargo.Core.Handlebars.Render( \'{{>loading_animation}}\', {extra_class: \'\'} ) %></div>\n\t\t\t</div>\n\n\t\t\t<% } %>\n\n\t\t\t<% if(cart.length > 0) { %>\n\t\t\t\n\t\t\t<div data-next style="flex:3" class="button-large col bg-blackest color-white tac clickable noselect flex outline pad-x-one-five pad-y-one display-block" style="font-size: 17px;">\n\t\t\t\t\n\t\t\t\t\t<div data-spinner class="psa"><%= Cargo.Core.Handlebars.Render( \'{{>loading_animation}}\', {extra_class: \'\'} ) %></div>\n\t\t\t\t\t<% if(collectShippingInformation) { %>\n\t\t\t\t\t<span class="type-bold">Next </span><span class="large-arrow social-font">î‹ï¸Ž</span>\n\t\t\t\t\t<% } else { %>\n\t\t\t\t\t<span class="type-bold">Checkout </span><span class="large-arrow social-font">î‹ï¸Ž</span>\n\t\t\t\t\t<% } %>\n\n\t\t\t</div>\n\n\t\t\t<%\t\n\t\t\t\t}\n\t\t\t%>\n\n\t\t<%\t\n\t\t\t}\n\t\t%>\n\t</div>\n</div>\n\n<style>\n\tinput[type="number"] {\n\t  -webkit-appearance: textfield;\n\t\t -moz-appearance: textfield;\n\t\t\t  appearance: textfield;\n\t}\n\tinput[type=number]::-webkit-inner-spin-button, \n\tinput[type=number]::-webkit-outer-spin-button { \n\t  -webkit-appearance: none;\n\t}\n</style>'}),define("text!ecommerce/templates/addressform.html",[],function(){return'<form class="group-vertical">\n\n\t\x3c!-- Countries Dropdown --\x3e\n\t<div data-input-parent internal-dropdown class="col row select dropdown bg-white pointer">\n\t\t<div data-select-cover class="pad-small select-cover-tab">\n\t\t\t<span class="cover_text color-gray-darker">Country</span>\n\t\t</div>\n\t\t<div data-select-cover class="pad-small select-cover-right">\n\t\t\t<span class="cover_label">\n\t\t\t\t<%= fieldNames.country %>\n\t\t\t</span>\n\t\t</div>\n\t\t<select class="form-control" id="<%= view_id %>-country" name="<%= fieldNames.country %>">\n\t\t\t<% _.each(countryMap, function(country, iso){ %>\n\t\t\t<option value="<%= iso %>" <%= iso === fieldValues.country ? \'selected\' : \'\' %>><%= country.name %></option>\n\t\t\t<% }); %>\n\t\t</select>\n\t\t<div class="arrow-select bg-white" style="background:#fff;">\n\t\t\t<div class="arrow-down-arrow-up"></div>\n\t\t</div>\n\t</div>\n\n\t\x3c!-- Address --\x3e\n\t<div class="row col col-full text pad-reset group-horizontal" data-input-parent="">\n\t\t<div data-label class="pointer text col bg-gray-lighter pad-small reset-after col-1-3 color-gray-darker no-select">\n\t\t\tAddress\n\t\t</div>\n\t\t<div class="pad-small position-relative col bg-white col-2-3" data-input-expand="">\n\t\t\t<input type="text" id="<%= view_id %>-address1" name="<%= fieldNames.address1 %>" value="<%= fieldValues.address1 %>" data-placeholder="" />\n\t\t</div>\n\t</div>\n\n\t\x3c!-- Apartment, suite, unit, building, floor --\x3e\n\t<div class="row col col-full text pad-reset group-horizontal" data-input-parent="">\n\t\t<div data-label class="pointer text col bg-gray-lighter pad-small reset-after col-1-3 color-gray-darker no-select">\n\t\t\tAddress 2\n\t\t</div>\n\t\t<div class="pad-small position-relative col bg-white col-2-3" data-input-expand="">\n\t\t\t<input type="text" id="<%= view_id %>-address2" name="<%= fieldNames.address2 %>" value="<%= fieldValues.address2 %>" data-placeholder="" />\n\t\t</div>\n\t</div>\n\n\t<div class="locality group-vertical">\n\n\t\t\x3c!-- City --\x3e\n\t\t<div class="row col col-full text pad-reset group-horizontal" data-input-parent="">\n\t\t\t<div data-label class="pointer text col bg-gray-lighter pad-small reset-after col-1-3 color-gray-darker no-select">\n\t\t\t\tCity\n\t\t\t</div>\n\t\t\t<div class="pad-small position-relative col bg-white col-2-3" data-input-expand="">\n\t\t\t\t<input type="text" id="<%= view_id %>-city" name="<%= fieldNames.city %>" value="<%= fieldValues.city %>" data-placeholder="" />\n\t\t\t</div>\n\t\t</div>\n\n\t\t\x3c!-- State --\x3e\n\t\t<div data-dynamic-input class="col select bg-white pointer" data-input-parent internal-dropdown>\n\t\t\t<input type="text" id="<%= view_id %>-state" name="<%= fieldNames.state %>" value="<%= fieldValues.state %>" data-placeholder="" />\n\t\t\t<div class="arrow-select bg-white">\n\t\t\t\t<div class="arrow-down-arrow-up"></div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t\x3c!-- Zip --\x3e\n\t\t<div class="row col col-full text pad-reset group-horizontal" data-input-parent="">\n\t\t\t<div data-label class="pointer text col bg-gray-lighter pad-small reset-after col-1-3 color-gray-darker no-select">\n\t\t\t\tZip\n\t\t\t</div>\n\t\t\t<div class="pad-small position-relative col bg-white col-2-3" data-input-expand="">\n\t\t\t\t<input type="text" id="<%= view_id %>-zip" name="<%= fieldNames.postal_code %>" value="<%= fieldValues.postal_code %>" data-placeholder="" />\n\t\t\t</div>\n\t\t</div>\n\n\t</div>\n\n</form>'}),define("text!ecommerce/templates/addressformDark.html",[],function(){return'<form class="group-vertical group" id="shipping_address_form">\n\n\t\x3c!-- Name --\x3e\n\t<div class="row col col-full text pad-reset negative-margin-bottom outline" data-input-parent>\n\t    <input type="text" id="<%= view_id %>-name" name="<%= fieldNames.name %>" value="<%= fieldValues.name %>" placeholder="Name..." data-required />\n\t</div>\n\n\t\x3c!-- Email --\x3e\n\t<div class="row col col-full text pad-reset negative-margin-bottom outline" data-input-parent>\n\t    <input type="text" id="<%= view_id %>-email" name="<%= fieldNames.email %>" value="<%= fieldValues.email %>" placeholder="Email..." data-required />\n\t</div>\n\n\n\t<% if(Cargo.Ecommerce.Model.shop && Cargo.Ecommerce.Model.shop.get(\'checkout_require_phone_number\')) { %>\n\t<div class="row col col-full text pad-reset negative-margin-bottom outline" data-input-parent>\n\t    <input type="text" id="<%= view_id %>-phone" name="<%= fieldNames.phone %>" value="<%= fieldValues.phone %>" placeholder="Phone..." data-required />\n\t</div>\n\t<% } %>\n\n\t\x3c!-- Countries Dropdown --\x3e\n\t<div data-input-parent internal-dropdown class="col col-full row select negative-margin-bottom outline" style="margin-top: 3rem;">\n\t\t<div data-select-cover class="pad-small select-cover">\n\t\t    <span class="cover_text"></span>\n\t\t    <span class="cover_label">\n\t\t        <%= fieldNames.country %>\n\t\t    </span>\n\t\t</div>\n\t\t<select class="form-control outline" id="<%= view_id %>-country" name="<%= fieldNames.country %>" data-required>\n\t\t\t<% _.each(countryMap, function(country, iso){ %>\n\t\t\t<option value="<%= iso %>" <%= iso === fieldValues.country ? \'selected\' : \'\' %>><%= country.name %></option>\n\t\t\t<% }); %>\n\t\t</select>\n\t\t<div data-settings-caret>\n\t\t\t<svg viewBox="0 0 14 8" style="enable-background:new 0 0 14 8;">\n\t\t\t\t<polygon points="7,8 0,1 0.7,0.3 7,6.6 13.3,0.3 14,1 \t"/>\n\t\t\t</svg>\n\t\t</div>\n\x3c!-- \t\t<div class="arrow-select">\n\t\t\t<div class="arrow-down-arrow-up"></div>\n\t\t</div> --\x3e\n\t</div>\n\t\n\t\x3c!-- Address --\x3e\n\t<div class="row col col-full text pad-reset negative-margin-bottom outline" data-input-parent>\n\t    <input type="text" id="<%= view_id %>-address1" name="<%= fieldNames.address1 %>" value="<%= fieldValues.address1 %>" data-placeholder="Address..." data-required />\n\t</div>\n\n\t\x3c!-- Apartment, suite, unit, building, floor --\x3e\n\t<div class="row col col-full text pad-reset negative-margin-bottom outline" data-input-parent>\n\t    <input type="text" id="<%= view_id %>-address2" name="<%= fieldNames.address2 %>" value="<%= fieldValues.address2 %>" data-placeholder="Apartment, suite, etc. (optional)..." />\n\t</div>\n\n\t<div class="row col-full locality group-vertical group">\n\t\t\n\t\t\x3c!-- City --\x3e\n\t\t<div class="row col col-full text pad-reset negative-margin-bottom outline" data-input-parent>\n\t\t       <input type="text" id="<%= view_id %>-city" name="<%= fieldNames.city %>" value="<%= fieldValues.city %>" data-required data-placeholder="City..." />\n\t\t</div>\n\n\t\t\x3c!-- State --\x3e\n\t\t<div class="col-no-height">\n\t\t\t<div internal-dropdown class="col col-full select negative-margin-bottom outline" data-input-parent>\n\t\t\t\t<input type="text" id="<%= view_id %>-state" name="<%= fieldNames.state %>" value="<%= fieldValues.state %>" data-required/>\n\t\t\t\t<div data-settings-caret>\n\t\t\t\t\t<svg viewBox="0 0 14 8" style="enable-background:new 0 0 14 8;">\n\t\t\t\t\t\t<polygon points="7,8 0,1 0.7,0.3 7,6.6 13.3,0.3 14,1 \t"/>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t\x3c!-- Zip --\x3e\n\t\t<div class="row col col-full text pad-reset negative-margin-bottom outline" data-input-parent>\n\t\t    <input type="text" id="<%= view_id %>-zip" name="<%= fieldNames.postal_code %>" value="<%= fieldValues.postal_code %>" data-required />\n\t\t</div>\n\n\t</div>\n\n</form>'}),function(e){"object"==typeof module&&"object"==typeof module.exports?e(require("jquery")):e(jQuery)}(function(e){e.fn.addressfield=function(t){var a,n=this,i=e.extend({fields:{},json:null,async:!0,defs:{fields:{}}},t);if(t.events)for(var r in t.events)this.on(r,t.events[r]);return"string"==typeof i.json?(e.ajax({dataType:"json",url:i.json,async:i.async,success:function(t){a=e.fn.addressfield.transform(t),e.fn.addressfield.initCountries.call(n,i.fields.country,a),e.fn.addressfield.binder.call(n,i.fields,a),e(i.fields.country,n).change()}}),n):"object"==typeof i.json&&null!==i.json?(a=e.fn.addressfield.transform(i.json),e.fn.addressfield.initCountries.call(n,i.fields.country,a),e.fn.addressfield.binder.call(n,i.fields,a),e(i.fields.country,n).change(),n):e.fn.addressfield.apply.call(n,i.defs,i.fields)},e.fn.addressfield.apply=function(t,a){var n,i,r,o,s,l=e(this),d=[];for(o in t.fields)if(t.fields.hasOwnProperty(o)){if(s=e.fn.addressfield.onlyKey(t.fields[o]),i=a.hasOwnProperty(s)?a[s]:"."+s,n=l.find(i),t.fields[o][s]instanceof Array)return e.fn.addressfield.apply.call(n,{fields:t.fields[o][s]},a);n.length&&a.hasOwnProperty(s)&&(d.push(i),void 0!==t.fields[o][s].options?(n.is("select")||(n=e.fn.addressfield.convertToSelect.call(n)),e.fn.addressfield.updateOptions.call(n,t.fields[o][s].options)):(n.is("select")&&(n=e.fn.addressfield.convertToText.call(n)),r=t.fields[o][s].hasOwnProperty("eg")?t.fields[o][s].eg:"",e.fn.addressfield.updateEg.call(n,r)),e.fn.addressfield.updateLabel.call(n,t.fields[o][s].label)),!e.fn.addressfield.isVisible.call(n)&&a.hasOwnProperty(s)&&e.fn.addressfield.showField.call(n),e.fn.addressfield.validate.call(n,s,t.fields[o][s])}return e.each(a,function(a,n){var i=l.find(n);i.length&&!e.fn.addressfield.hasField(t,a)&&e.fn.addressfield.hideField.call(i)}),e.fn.addressfield.orderFields.call(l,d),l.trigger("addressfield:after",{config:t,fieldMap:a}),this},e.fn.addressfield.initCountries=function(t,a){var n,i=this.find(t+":not(:has(>option))");i.length&&(n=i.attr("data-country-selected"),e.each(a,function(t,a){void 0!==n&&t.toLowerCase()===n.toLowerCase()?i.append(e("<option></option>").attr("value",t).attr("selected","selected").text(a.label)):i.append(e("<option></option>").attr("value",t).text(a.label))}))},e.fn.addressfield.binder=function(t,a){var n=this;return n.find(t.country).bind("change",function(){this.options[this.selectedIndex]&&this.options[this.selectedIndex].disabled||e.fn.addressfield.apply.call(n,a[this.value],t)}),n},e.fn.addressfield.transform=function(e){var t,a={};for(t in e.options)a[e.options[t].iso]=e.options[t];return a},e.fn.addressfield.onlyKey=function(e){for(var t in e)return t},e.fn.addressfield.hasField=function(t,a){var n,i;for(n in t.fields){if(i=e.fn.addressfield.onlyKey(t.fields[n]),t.fields[n][i]instanceof Array)return e.fn.addressfield.hasField({fields:t.fields[n][i]},a);if(i===a)return!0}return!1},e.fn.addressfield.updateLabel=function(t){var a=e(this),n=a.attr("id");(e('label[for="'+n+'"]',a.get(0).ownerDocument)||a.prev("label")).text(t)},e.fn.addressfield.updateEg=function(t){var a=t?"e.g. "+t:"";e(this).attr("placeholder",a)},e.fn.addressfield.updateOptions=function(t){var a=e(this),n=a.data("_saved")||a.val();a.children("option").remove(),e.each(t,function(n){var i=e.fn.addressfield.onlyKey(t[n]);a.append(e("<option></option>").attr("value",i).text(t[n][i]))}),a.val(n).change(),a.removeData("_saved")},e.fn.addressfield.convertToText=function(){var t=e(this),a=e("<input />").attr("type","text");return t.next("[data-settings-caret]",this.context).hide(),e.fn.addressfield.copyAttrsTo.call(t,a),t.is('input[type="text"]')&&a.val(t.val()),t.replaceWith(a),a},e.fn.addressfield.convertToSelect=function(){var t=e(this),a=e("<select></select>");return t.next("[data-settings-caret]",this.context).show(),e.fn.addressfield.copyAttrsTo.call(t,a),a.data("_saved",t.val()),t.replaceWith(a),a},e.fn.addressfield.validate=function(t,a){var n=e(this),i="isValid_"+t,r={},o="Please check your formatting.";void 0!==e.validator&&(o=e.validator.messages.hasOwnProperty(i)?e.validator.messages[i]:o,a.hasOwnProperty("format")?(e.validator.addMethod(i,function(t){return new RegExp(a.format,"i").test(e.trim(t.toString()))},o),r[i]=!0,n.rules("add",r)):e.validator.addMethod(i,function(){return!0},o))},e.fn.addressfield.hideField=function(){e(this).val("").hide(),e.fn.addressfield.container.call(this).hide()},e.fn.addressfield.showField=function(){this.show(),e.fn.addressfield.container.call(this).show()},e.fn.addressfield.isVisible=function(){return e(this).is(":visible")},e.fn.addressfield.container=function(){var t=e(this),a=t.attr("id"),n=e('label[for="'+a+'"]',t.get(0).ownerDocument)||t.prev("label");return"function"==typeof e.fn.has?t.parents().has(n).first():t.parents().find(":has(label):has(#"+a+"):last")},e.fn.addressfield.copyAttrsTo=function(t){var a=["class","id","name","propdescname","data-placeholder","data-required"],n=e(this);e.each(n[0].attributes,function(){-1!==e.inArray(this.name,a)&&("propdescname"===this.name?t.attr("name",this.value):t.attr(this.name,this.value))})},e.fn.addressfield.orderFields=function(t){var a=e(this),n=e().not(document);e.each(t,function(t,i){var r=e.fn.addressfield.container.call(a.find(i));n.push(r[0])}),n.detach().appendTo(a)}}),define("ecommerce/libs/jquery.addressfield.min",function(){}),define("ecommerce/views/addressform",["https://static.cargo.site/assets/ecommerce/addressfield.min.json.js","text!ecommerce/templates/addressform.html","text!ecommerce/templates/addressformDark.html","ecommerce/helpers","ecommerce/libs/jquery.addressfield.min"],function(e,t,a,n){$.fn.addressfield.hideField=_.wrap($.fn.addressfield.hideField,function(e){var t=Array.prototype.slice.call(arguments);t.shift(),e.apply(this,t),this[0]&&this[0].parentNode&&this[0].parentNode.hasAttribute("data-input-parent")&&(this[0].parentNode.style.display="none")}),$.fn.addressfield.showField=_.wrap($.fn.addressfield.showField,function(e){var t=Array.prototype.slice.call(arguments);t.shift(),e.apply(this,t),this[0]&&this[0].parentNode&&this[0].parentNode.hasAttribute("data-input-parent")&&(this[0].parentNode.style.display="")}),$.fn.addressfield.updateEg=function(e){this[0]&&e&&this[0].setAttribute("data-example",e)},$.fn.addressfield.updateLabel=function(e){this[0]&&(e+="...",this[0].hasAttribute("data-placeholder")?e=this[0].getAttribute("data-placeholder"):this[0].hasAttribute("data-example"),this[0].setAttribute("placeholder",e))};var i={name:"name",email:"email",address1:"address1",address2:"address2",city:"city",country:"country",postal_code:"postal_code",state:"state",phone:"phone"},r={country:"US"};return Backbone.View.extend({template:_.template(t),darkTemplate:_.template(a),id:function(){return this.cid},events:{},initialize:function(e){e=e||{},this.use_dark=e.use_dark,this.fieldNames=_.extend({},i,e.fieldNames),this.fieldValues=_.extend({},r,e.fieldValues),this.countryMap=n.getCountryMap()},limitDestinations:function(e){e&&(this.allowedDestinations=e,this.fieldValues.country&&!e.hasOwnProperty(this.fieldValues.country)&&(this.fieldValues.country=void 0))},render:function(t){if(this.currentRenderOptions=t=t||void 0,0!==_.keys(this.countryMap).length){var a={view_id:this.cid,countryMap:this.countryMap,fieldNames:this.fieldNames,fieldValues:this.fieldValues};this.use_dark?this.el.innerHTML=this.darkTemplate(a):this.el.innerHTML=this.template(a),this.handleSelectCoverUI();var n=this.$el.find("form");return this.addressField=n.addressfield({json:e,fields:{country:"#"+this.cid+"-country",thoroughfare:"#"+this.cid+"-address1",premise:"#"+this.cid+"-address2",localityname:"#"+this.cid+"-city",administrativearea:"#"+this.cid+"-state",postalcode:"#"+this.cid+"-zip"},events:{"addressfield:after":this.afterAddressFieldUpdate.bind(this)}}),this}this.el.innerHTML="No shipping destinations available."},afterAddressFieldUpdate:function(e,t){var a=this.el.querySelector("form");_.each(a.querySelectorAll("input"),function(e){var t=$(e).closest("[data-input-parent]");"none"===e.style.display?t.css("display","none"):t.css("display","")});var n="",i=a.querySelector(t.fieldMap.administrativearea);if(_.each(t.config.fields,function(e){e.administrativearea&&(n=e.administrativearea.label,i&&"SELECT"===i.nodeName&&(this.fieldValues&&this.fieldValues.state&&(i.value=this.fieldValues.state),"shipping_address_form"==a.id?i.options[0].textContent=n+"...":i.options[0].textContent=n,i.options[0].disabled=!0,i.options[0].removeAttribute("value")))},this),i){if(void 0!==this.allowedDestinations){for(var r=a.querySelector(t.fieldMap.country),o=r.options.length-1;o>=0;o--)this.allowedDestinations.hasOwnProperty(r.options[o].value)||r.options[o].remove();if(0===_.keys(this.allowedDestinations).length&&$(r).parent().find(".cover_label").text("Country...").css("color","rgba(255, 255, 255, .4)"),"SELECT"===i.nodeName&&this.allowedDestinations[r.value]&&this.allowedDestinations[r.value].areas){var s=this.allowedDestinations[r.value].areas;for(o=i.options.length-1;o>=0;o--)s.includes(i.options[o].value)||i.options[o].remove()}}var l=i.closest("[data-dynamic-input]");if(l)if("none"===i.style.display)l.style.display="none";else if(l.style.display="flex",l.innerHTML="","INPUT"===i.nodeName){l.className="row col col-full text pad-reset group-horizontal",l.removeAttribute="internal-dropdown",l.setAttribute("data-input-parent","");var d=document.createElement("div");d.className="text col bg-gray-lighter pad-small reset-after col-1-3 color-gray-darker",d.setAttribute("data-label",""),d.textContent=n,l.appendChild(d);var c=document.createElement("div");c.className="pad-small position-relative col bg-white col-2-3",c.setAttribute("data-input-expand",""),l.appendChild(c),c.appendChild(i)}else if("SELECT"===i.nodeName){l.className="col row select dropdown bg-white",l.removeAttribute="data-input-parent",l.setAttribute("internal-dropdown","");var u=document.createElement("div");u.className="pad-small select-cover-tab";var h=document.createElement("span");h.className="cover_text color-gray-darker",h.textContent=n,u.appendChild(h);var p=document.createElement("div");p.className="pad-small select-cover-right",p.setAttribute("data-select-cover","");var m=document.createElement("span");m.className="cover_label",m.setAttribute("set-on-view",!0),m.innerText="",p.appendChild(m);var g=document.createElement("div"),f=document.createElement("div");g.className="arrow-select bg-white",f.className="arrow-down-arrow-up",g.appendChild(f),l.appendChild(u),l.appendChild(p),l.appendChild(i),l.appendChild(g)}}this.handleSelectCoverUI(),this.trigger("fields-updated")},handleSelectCoverUI:function(){this.$el.find("[data-select-cover]").each(function(){var e=this.querySelector(".cover_label"),t=this.nextElementSibling;if(null!==e&&null!==t&&"SELECT"===t.nodeName&&(t.addEventListener("change",function(a){e.textContent=t.options[t.selectedIndex].textContent.trim(),t.options[t.selectedIndex]&&t.options[t.selectedIndex].disabled?e.style.color="rgba(255, 255, 255, .4)":e.style.color=null}),-1!==t.selectedIndex)){var a=t.options[0].innerText==t.options[t.selectedIndex].textContent,n=t.options[0].hasAttribute("disabled");a&&n||(e.textContent=t.options[t.selectedIndex].textContent.trim())}})},serialize:function(){return _.reduce(this.addressField.serializeArray(),function(e,t){return e[t.name]=t.value,e},{})}})}),define("ecommerce/models/order",["global_libs/backbone/backbone-nested"],function(){return Backbone.NestedModel.extend({idAttribute:"order_id",basePath:Cargo.API.GetBasePath()+"/ecommerce/v2/orders/",initialize:function(){},url:function(){return this.basePath+(this.id||"")},fetch:function(e){return(e=e||{}).order_number?(e.url=this.basePath+e.order_number+"/bynumber",Backbone.Model.prototype.fetch.call(this,e)):Backbone.Model.prototype.fetch.apply(this,arguments)},parse:function(e){return null!==e.metadata&&"object"==typeof e.metadata||(e.metadata={}),e},getPaymentIntent:function(e){return"ideal"===e.type?$.getJSON(this.url()+"/getidealintent"):$.getJSON(this.url()+"/getintent")},capturePaymentIntent:function(e){return $.ajax({type:"POST",url:this.url()+"/capturestripe",data:{payment_intent_id:e},dataType:"json"})},capturePayPal:function(e){return $.ajax({type:"POST",url:this.url()+"/capturepaypal",data:{orderID:e.orderID},dataType:"json"})},confirmFree:function(){return $.ajax({type:"POST",url:this.url()+"/confirmfree",dataType:"json"})}})}),define("ecommerce/views/client/cart",["text!ecommerce/templates/client/cart.html","ecommerce/views/addressform","ecommerce/models/order","ecommerce/helpers"],function(e,t,a,n){return Backbone.View.extend({template:_.template(e),preventReRender:!1,className:"ecommerce-cart",events:{"click [data-close]":"close","click [data-next]":"handleNavigation","click [data-payment]":"renderPaymentPage","click [data-cancel-shipping]":"cancelShipping","click [data-remove]":"removeFromCart",'change [name="faux_qty_select"]':"changeFauxQuantitySelect",'keyup [name="quantity"]':"handleQuantityInputKeyup",'keydown [name="quantity"]':"handleQuantityInputKeydown"},initialize:function(e){this.initializing=!0,this.renderAddressForm=e.loadAddressForm,this.handleQuantityInputBlur=this.handleQuantityInputBlur.bind(this),this.el.addEventListener("blur",this.handleQuantityInputBlur,{capture:!0}),this.showLoader=e.showLoader,this.hideLoader=e.hideLoader,this.showLoader();try{parent&&parent.Cargo&&parent.Cargo.Helper.isSafari()&&this.$el.addClass("safari")}catch(e){}null!==e.orderId?(this.existingOrder=new a({order_id:e.orderId}),this.existingOrder.fetch().then(function(e){Cargo.Ecommerce.Collection.cart.reset(),_.each(this.existingOrder.get("items"),function(e){Cargo.Ecommerce.Collection.cart.add(e,{amount:e.quantity})}),this.finalizeInit()}.bind(this),function(){Cargo.Router.navigate("cart",{trigger:!0})}.bind(this))):this.finalizeInit(),this.cartItems=[]},finalizeInit:function(){this.initializing=!1,this.renderAddressForm&&(this.addressForm=new t({fieldValues:{country:Cargo.Ecommerce.Model.shop.get("shop_country")||"US"},use_dark:!0}),this.addressForm.on("fields-updated",function(e,t){var a=this.el.querySelector('select[name="state"]');if(a){var n=a.options[a.selectedIndex];n&&n.disabled&&(a.style.color="rgba(255,255,255,.4)",a.style.webkitTextFillColor="rgba(255,255,255,.4)"),$(a).on("change",function(){var e=this.options[this.selectedIndex];e&&e.disabled?(this.style.color="rgba(255,255,255,.4)",this.style.webkitTextFillColor="rgba(255,255,255,.4)"):(this.style.color=null,this.style.webkitTextFillColor=null)})}}),void 0!==this.existingOrder&&this.fillAddress()),this.listenTo(Cargo.Ecommerce.Collection.cart,"update reset change:quantity",this.renderCartItems),Cargo.Ecommerce.Collection.products.fetchMultiple(Cargo.Ecommerce.Collection.cart.pluck("product_id"),{always:function(){this.render()}.bind(this)})},handleClick:function(e){$(e.target).is("#faux_qty_select")&&(this.preventReRender=!0,setTimeout(_.bind(function(){this.preventReRender=!1},this),1e3))},setCartItems:function(){this.orderIsShippable=!0,!0===Cargo.Ecommerce.Model.shop.get("has_tax")&&(this.orderIsShippable=!0);var e=0;return this.cartItems=_.without(Cargo.Ecommerce.Collection.cart.map(function(t){return t.productModel=Cargo.Ecommerce.Collection.products.get(t.get("product_id")),t.productModel?(t.variantModel=t.productModel.variantCollection.get(t.get("variant_id")),t.variantModel?(null!==t.variantModel.get("inventory")&&t.get("quantity")>t.variantModel.get("inventory")&&(t.attributes.quantity=t.variantModel.get("inventory")),t.get("quantity")<=0?null:(t.variantModel.get("is_shippable")&&(this.orderIsShippable=!0),e+=t.get("quantity")*t.variantModel.get("price"),t)):null):null},this),null),0===e&&(this.orderIsShippable=!0),this.cartItems},render:function(e){if(!this.initializing){if(this.currentRenderOptions=e=e||{},this.setCartItems(),this.existingOrder&&0===this.cartItems.length)return this.preventReRender=!0,Cargo.Ecommerce.Collection.cart.reset(),void Cargo.Router.navigate("cart",{trigger:!0});if(this.renderAddressForm){if(this.renderAddressForm){if(Cargo.Ecommerce.Model.shop.get("use_shipping_zone")){if(this.fetchingShippingZones)return;if(void 0===this.shippingDestinations){this.fetchingShippingZones=!0;var t=arguments;return void $.getJSON(Cargo.API.GetBasePath()+"/ecommerce/v2/shop/"+Cargo.Model.Site.get("account_shop_id")+"/shippingzones/").always(function(e){this.fetchingShippingZones=!1,this.shippingDestinations={},_.each(e,function(e){_.each(e.countries,function(e,t){this.shippingDestinations.hasOwnProperty(t)?e.hasOwnProperty("areas")?this.shippingDestinations[t].areas&&e.areas&&(this.shippingDestinations[t].areas=_.uniq(this.shippingDestinations[t].areas.concat(e.areas))):delete this.shippingDestinations[t].areas:this.shippingDestinations[t]=_.clone(e)},this)},this),this.render.apply(this,t)}.bind(this))}}this.el.innerHTML=this.template({cart:this.cartItems,collectShippingInformation:this.renderAddressForm,hasNoShippableItems:this.hasNoShippableItems(),totalCartItems:Cargo.Ecommerce.Collection.cart.getTotalCartItemCount(),skipToCheckout:void 0!==this.existingOrder});var a=this.el.querySelector("#shipping_address");0===a.children.length&&(a.appendChild(this.addressForm.el),!0!==this.addressFormHasRendered&&(void 0!==this.shippingDestinations&&this.addressForm.limitDestinations(this.shippingDestinations),this.addressForm.render(),this.addressFormHasRendered=!0))}}else this.el.innerHTML=this.template({cart:this.cartItems,totalCartItems:Cargo.Ecommerce.Collection.cart.getTotalCartItemCount(),collectShippingInformation:this.renderAddressForm,formatPriceForCurrency:n.formatPriceForCurrency,skipToCheckout:void 0!==this.existingOrder});return this.hideLoader(),this}},removeFromCart:function(e){var t,a=(t=(t=e.dataset?e.dataset.change:e.currentTarget.dataset.change).split(","))[0],n=t[1];t&&(t=t,Cargo.Ecommerce.Collection.cart.remove(Cargo.Ecommerce.Collection.cart.findWhere({product_id:a,variant_id:n})))},getItemQuantity:function(e){var t=e.currentTarget.getAttribute("data-change").split(","),a=t[0],n=t[1];if(a&&n){var i=Cargo.Ecommerce.Collection.products.findWhere({product_id:a}),r=i.variantCollection.findWhere({variant_id:n});if(r)return r.get("inventory");if(i)return i.get("inventory")}return!1},changeFauxQuantitySelect:function(e){var t=$(e.currentTarget).val(),a=this.getItemQuantity(e);if(null==a||-1==parseInt(a));else if(null!==a&&a<parseInt(t))return e.preventDefault(),Cargo.Modal.Alert({selector:"html",message:"Youâ€™ve reached the maximum available stock"}),Cargo.Modal.$el.find(".confirm-box").css({top:""}),void Cargo.Modal.$el.find(".modal-overlay").css({top:""});setTimeout(_.bind(function(){this.updateCart(e);var t=this.$el.find('input[data-change="'+e.target.dataset.change+'"]');if(t){t.focus();var a=t.val();t.val(""),t.val(a)}},this),10)},updatePriceDisplay:function(e,t){e.preventDefault(),$(e.currentTarget).closest("[data-item]").find("[data-price]").html(t)},updateTotalPrice:function(e){var t=$("[data-total-price]",this.el)[0],a=0;if(t){_.each(this.cartItems,function(e){var t=e.get("quantity")*e.variantModel.get("price");a+=t});var i=n.formatPriceForCurrency(a);t.innerHTML=i,this.preventReRender=!1}},handleManualDisplayChange:function(e){setTimeout(_.bind(function(){this.setSelectValue($(e.currentTarget)),this.preventReRender=!0,this.updateCart(e);var t=e.currentTarget.getAttribute("data-change").split(","),a=t[0],n=t[1],i=this.getPriceChange(a,n);i&&(this.updatePriceDisplay(e,i),this.updateTotalPrice(e))},this),1)},handleQuantityInputBlur:function(e){this.ignoreBlur||!1===e.target.hasAttribute("data-change")||0==e.target.value&&this.removeFromCart(e.target)},handleQuantityInputKeydown:function(e){e.keyCode>=37&&e.keyCode<=40?(e.currentTarget.value<1&&(e.preventDefault(),38==e.keyCode?$(e.target).val(1):$(e.target).val(" ")),this.handleManualDisplayChange(e)):e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=105||9==e.keyCode||8==e.keyCode||e.metaKey||8==e.keyCode||e.preventDefault()},handleQuantityInputKeyup:function(e){13==e.keyCode?$(e.target).blur():(e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=105||9==e.keyCode||8==e.keyCode)&&(e.currentTarget.value<0&&(e.preventDefault(),$(e.target).val("")),this.handleManualDisplayChange(e));var t=this.getItemQuantity(e);null!==t&&-1!==t&&t<parseInt(e.currentTarget.value)&&(e.preventDefault(),Cargo.Modal.Alert({selector:"html",message:"Youâ€™ve reached the maximum available stock"}),Cargo.Modal.$el.find(".confirm-box").css({top:""}),Cargo.Modal.$el.find(".modal-overlay").css({top:""}),$(e.target).val(this.getItemQuantity(e)))},setQuantityInputWidth:function(e){if(0!=e.next("[data-text-measure]").length){var t=e.val();if(!(parseInt(t)<=9)){var a=e.closest(".quantity-wrapper"),n=a.find(".arrow-select"),i=a.find("#faux_qty_select");n.hide(),i.hide(),a.css("width","100px"),e.addClass("outline"),e.focus(),e.text(""),setTimeout(function(){console.log("focus");var t=document.createRange(),a=window.getSelection();t.selectNodeContents(e[0]),t.collapse(),a.removeAllRanges(),a.addRange(t)},50)}}},setSelectValue:function(e){var t=e.nextAll('[name="faux_qty_select"]')[0];if(t){var a=e.val();a>=10&&(a=10),t.value=a}},getPriceChange:function(e,t){if(e&&t){var a,i=Cargo.Ecommerce.Collection.products.findWhere({product_id:e}),r=i.variantCollection.findWhere({variant_id:t});a=r?r.get("price"):i.get("price");var o=Cargo.Ecommerce.Collection.cart.findWhere({product_id:e,variant_id:t});return a*=o=o.get("quantity"),updated_price=n.formatPriceForCurrency(a),updated_price}return!1},clearCart:function(){this.cart=[],this.saveCart(),this.render()},addMoreToCart:function(e){var t=e.currentTarget.getAttribute("data-change").split(","),a=t[0],n=t[1];a&&n&&this.addToCart(a,n,1)},updateCart:function(e){var t=$(e.currentTarget).val(),a=e.currentTarget.getAttribute("data-change").split(","),n=a[0],i=a[1];if(n&&i){var r=Cargo.Ecommerce.Collection.cart.findWhere({product_id:n,variant_id:i});if(r){""!=t&&" "!=t&&null!=t&&null!=t||(t=0,(t=parseInt(t))<=0&&(t=0));var o=r.get("quantity");if(r.set("quantity",parseInt(t)),this.ignoreBlur=!0,this.preventReRender){if(0!==t&&(o<=9&&parseInt(t)>9||o>=9&&parseInt(t)<9)){if(0===t)return;this.render();var s=this.$el.find('input[data-change="'+e.target.dataset.change+'"]');if(s){s.focus();var l=s.val();s.val(""),s.val(l)}}}else this.render();this.ignoreBlur=!1}}},handleNavigation:function(){if(Cargo.API.Config.is_template)return Cargo.Modal.Alert({selector:"html",message:"<em>This is a demo of <br>&nbsp;&nbsp;<a style='color: #222222; padding-bottom: 0.1em; border-bottom: 1px solid rgba(0,0,0,.5); text-decoration: none;' href='https://cargo2support.cargo.site/cargo-commerce' target='_blank'>Cargo Commerce</a><span style='font-family: -apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,Oxygen,Ubuntu,Cantarell,\"Open Sans\",\"Helvetica Neue\",sans-serif, Icons; color: rgba(0, 0, 0, 0.4); border-bottom: 0;'><sup>îŽï¸Ž</sup></span></em>"}),Cargo.Modal.$el.find(".confirm-box").css({top:""}),void Cargo.Modal.$el.find(".modal-overlay").css({top:""});this.orderIsShippable?this.renderAddressForm?this.goToCheckout():this.goToAddressForm():this.goToCheckout()},goToAddressForm:function(){this.existingOrder?this.goToCheckout():Cargo.Router.navigate("cart/address",{trigger:!0})},fillAddress:function(){this.existingOrder&&(this.addressForm.fieldValues=_.extend(this.addressForm.fieldValues,this.existingOrder.get("address"),{email:this.existingOrder.get("email"),name:this.existingOrder.get("name")}),this.addressForm.render())},addressFormIsValid:function(){var e=this.addressForm.addressField[0],t=!1,a=/^\s*(?:\+?(\d{1,3}))?([-. (]*(\d{3})[-. )]*)?((\d{3})[-. ]*(\d{2,4})(?:[-.x ]*(\d+))?)\s*$/gi,n=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/gi;return e&&_.each(e.elements,function(e){if(!e.hasAttribute("disabled")){$(e).closest("[data-input-parent]").removeClass("error");var i=e.getAttribute("name"),r="";"SELECT"===e.nodeName?e.selectedOptions[0]&&!0!==e.selectedOptions[0].disabled&&(r=e.selectedOptions[0].getAttribute("value")||""):r=e.value,"email"!==i||"string"==typeof r&&n.test(r)?"phone"===i&&null===r.match(a)?($(e).closest("[data-input-parent]").addClass("error"),t=!0):e.hasAttribute("data-required")&&""===r&&"none"!==e.style.display&&($(e).closest("[data-input-parent]").addClass("error"),t=!0):($(e).closest("[data-input-parent]").addClass("error"),t=!0)}},this),!t},goToCheckout:function(){if(this.existingOrder&&!this.renderAddressForm){var e=this.existingOrder.pick("address","name","email","selected_shipping_id");e.items=_.map(this.cartItems,function(e){return e.toJSON()});var t=new a(e)}else{var i=null,r=null;if(this.orderIsShippable&&this.addressForm){if(!1===this.addressFormIsValid())return;i=this.addressForm.serialize(),customerName=i.name,r=i.email;var o=n.getCountryMap();o&&o[i.country]&&(i.full_country=o[i.country].name),"HK"===i.country&&(i.postal_code="0000"),delete i.name,delete i.email}if(this.orderIsShippable){var s=void 0;this.existingOrder&&(s=this.existingOrder.get("selected_shipping_id"));t=new a({items:_.map(this.cartItems,function(e){return e.toJSON()}),address:i,name:customerName,email:r,selected_shipping_id:s})}else t=new a({items:_.map(this.cartItems,function(e){return e.toJSON()})})}this.el.querySelector("[data-next]").classList.add("loading"),t.get("selected_shipping_id")&&(Cargo.Ecommerce.__restored_shipping_id__=t.get("selected_shipping_id")),t.save(void 0,{success:function(){Cargo.Ecommerce.OrderModel=t,Cargo.Router.navigate("cart/checkout/"+t.id,{trigger:!0})}.bind(this),error:function(e,t){this.el.querySelector("[data-next]").classList.remove("loading"),this.render();var a="Something went wrong, please try again";t&&t.responseJSON&&t.responseJSON.message&&(a=t.responseJSON.message),this.showAlertModal(a)}.bind(this)})},showAlertModal:function(e){Cargo.Modal.Alert({selector:"html",message:e}),Cargo.Modal.$el.find(".confirm-box").css({top:""}),Cargo.Modal.$el.find(".modal-overlay").css({top:""})},cancelShipping:function(){this.existingOrder?(Cargo.Router.navigate("cart/"+this.existingOrder.id,{trigger:!0}),this.render()):(Cargo.Router.navigate("cart/",{trigger:!0}),this.render())},close:function(){Cargo.View.Following.Toggle()},renderCartItems:function(){this.preventReRender||this.render()},hasNoShippableItems:function(){var e=!0;return _.filter(this.cartItems,function(t){1==t.variantModel.get("is_shippable")&&(e=!1)}),e}})}),define("text!ecommerce/templates/client/checkout.html",[],function(){return'<div class="x flex-end">\n\n    <div class="overflow-auto position-cover cart-padding" style="padding-bottom: 6rem;">\n\n        <div data-close class="x flex-end pos-abs clickable">\n            <div style="display: contents;">\n                <svg width="17px" height="17px">\n                    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" opacity="0.400000006">\n                        <g id="Group" transform="translate(1.000000, 1.000000)" stroke="#FFFFFF" stroke-width="2">\n                            <path d="M0,0 L15,15" id="Path-3"></path>\n                            <path d="M0,0 L15,15" id="Path-3" transform="translate(7.500000, 7.500000) rotate(-270.000000) translate(-7.500000, -7.500000) "></path>\n                        </g>\n                    </g>\n                </svg>\n            </div>\n        </div>\n\n        <div data-order-wrapper style="visibility: hidden;">\n    \n            <div class="pad-medium-small pad-left-reset pad-top-reset pad-bottom-reset lh-1 color-white">\n                <div class="no-select type-size-big">\n                    <% if (order.shipping && order.shipping.length > 1) { %>\n                        Select Shipping\n                    <% } else { %>\n                        Payment\n                    <% } %>\n                </div>\n            </div>\n\n            <div data-order-summary-container class="pad-top-medium"></div>\n            \n            <% if (canTakePurchases) { %>\n            <div data-payment-options class="flex flex-col hidden"></div>\n            <% } else { %>\n            <div class="col col-full color-white pad-top-medium">Shop is in demo mode.</div>\n            <% } %>\n\n            <div data-order-number  style="display:none;" >\n                <span style="float:right;" class="type-size-tiny type-upper color-grey-medium tar">\n                    order id: <%= order.order_id %>\n                </span>\n            </div>\n            \n        </div>\n\n    </div>\n</div>'}),define("text!ecommerce/templates/client/ordersummary.html",[],function(){return'<% \n    if( order.address !== null && order.address !== {} ){\n%>\n\x3c!------------------------ \n    Shipping \n------------------------\x3e\n      <% if (order.shipping && order.shipping.length > 1) { %>\n\n            <div class="col no-select pad-bottom-medium color-white" data-shipping-method-container>\n\n                <% \n                    _.each(order.shipping, function(shippingmethod){ \n                        var checked = shippingmethod.id == order.selected_shipping_id;\n                        var item_amount = helpers.formatPriceForCurrency(shippingmethod.amount, order.currency);\n                %>\n                            <div class="col col-full negative-margin-bottom outline radio" data-shipping-option>\n\n                                    <input type="radio" name="shipping_method" value="<%= shippingmethod.id %>" id="<%= shippingmethod.id %>" <% if(checked) { print(\'checked\') }%> style="visibility: hidden; display: none;">\n                                    <label for="<%= shippingmethod.id %>" class="pad-small grid shipping-price clickable">\n                                        <div class="type-ellipses pad-x-small pad-left-reset">\n                                            <span class="shipping-option-text"><% if(checked) { %><b>âœ“</b>&nbsp;&nbsp;<% } %><%= shippingmethod.provider %> <%= shippingmethod.servicelevel %></span>\n                                        </div>\n                                        <div><%= item_amount %></div> \n                                    </label>\n\n                            </div>\n\n                <% }); %>\n\n            </div>\n            <% } %> \n         <% } %>\n\n         <% if(previousShippingIdNotAvailable) { %>\n            <div class="pad-bottom-medium" style="color: #f03;">\n                The previously selected shipping is no longer available. Please review your shipping options.\n            </div>\n         <% } %>\n\n\x3c!------------------------ \n    Order Summary\n------------------------\x3e\n        <div class="outline pad-block-small negative-margin-bottom psr" data-cart-summary>\n           \n            <div id="order_summary" class=" color-white">\n                <div class="group-vertical" data-order-summary>\n                    <div class="grid multi-line" style="grid-template-columns: auto .1fr;">\n                    \t<% \n                            var total_amount = helpers.formatPriceForCurrency(order.total, order.currency)\n\n                            _.each(order.items, function(item){\n\n                        \t\tvar item_cost = item.quantity * item.price,\n                                    item_cost = helpers.formatPriceForCurrency(item_cost, order.currency),\n                                    attributes = item.attributes,\n                                    item_name = item.name\n\n                    \t%>\n\n                            \x3c!-- item --\x3e\n                            \x3c!-- <div class="pad-x-small pad-left-reset"><%= item.quantity %></div> --\x3e\n                            <div class=""><% if (item.quantity > 1) { %><%= item.quantity %> Ã— <% } %><%= item_name %></div>\n                            <div class="tar pad-x-small pad-right-reset"><%= item_cost %></div>\n                            \x3c!-- variants --\x3e\n                            \x3c!-- <div class="pad-x-small pad-left-reset"></div> --\x3e\n                            <div class="" style="color: rgba(255,255,255,.4)">\n                                <%= _.values(attributes).join(\', \') %>\n                            </div>\n                            <div class=""></div>\n\n                  \t \t<% }) %>\n                    </div>\n                    \n\n\x3c!------------------------ \n    Tax & Shipping\n------------------------\x3e\n                <div class="grid item-price multi-line" style="">\n                    \x3c!-- taxes --\x3e\n                    <% if (order.tax_amount > 0) { %>\n                        <div class="pad-left-reset">\n                            Tax\n                        </div>\n                        <div class="tar pad-right-reset">\n                            <%= helpers.formatPriceForCurrency(order.tax_amount, order.currency) %>\n                        </div>\n                    <% } %>\n\n\n                    \x3c!-- shipping --\x3e\n                    <% \n                        var selectedShippingRate = _.findWhere(order.shipping, {id: order.selected_shipping_id});\n\n                        if(selectedShippingRate){ \n                    %> \n                        <div class="pad-left-reset">\n                            Shipping\n                        </div>\n                        <div class="tar pad-right-reset">\n                            <%= helpers.formatPriceForCurrency(selectedShippingRate.amount, order.currency) %>\n                        </div>\n                    <% } %>\n                    \n\n\x3c!------------------------ \n    Totals\n------------------------\x3e\n                    \n                    <div class="pad-left-reset type-bold tar" style="padding-top: 2rem;">\n                        \n                    </div>\n                    <div class="tar pad-x-small pad-right-reset" style="padding-top: 2rem;">\n                        Total: <%= total_amount %>\n                    </div>\n\n                </div>\n            </div>\n        </div>\n    </div>\n\n\n\n    \x3c!------------------------ \n        Address\n    ------------------------\x3e\n    <% \n        if( order.address !== null && order.address !== undefined ){\n            if( order.address.address1.length > 0 ){\n    %> \n            <div class="outline pad-block-small negative-margin-bottom psr" data-address-summary>\n\n                \x3c!-- <div data-edit-address="" class="clickable color-grey-medium type-small-caps tar position-absolute">\n                    edit\n                </div> --\x3e\n\n\n                \x3c!-- <div class="grid item-close">\n                    <div class="color-white" style="color: rgba(255,255,255,.4)">\n                       Ship To\n                    </div>\n                   \n                </div> --\x3e\n                <div class=" color-white">\n                    <div data-address-display class="grid item-price multi-line">\n                        <div class="ls-0"><%= order.name %></div>\n                        <div></div>\n                        <div class="ls-0"><%= order.address.address1 %></div>\n                        <div></div>\n                        <div class="ls-0"><%= order.address.address2 %></div>\n                        <div></div>\n                        <div class="ls-0"><%= order.address.city %>, <%= order.address.state %> <%= order.address.postal_code %></div>\n                        <div></div>\n                        <div class="ls-0"><%= helpers.getCountryMap()[order.address.country].name %></div>\n                        <div></div>\n                        <div class="ls-0"><%= order.email %></div>\n                        <div></div>\n                        <% if(order.address.phone) { %>\n                        <div class="ls-0"><%= order.address.phone %></div>\n                        <div></div>\n                        <% } %>\n                    </div>\n                </div>\n            </div>\n\n            <% if (shop.checkout_note_enabled) { %>\n            <div class="pos-rel">\n                <div class="pos-abs memo-emoji">&#128221;</div>\n                <div class="outline pad-block-small">\n                    <div style="line-height: 0;">\n                        <textarea data-order-note maxlength="400" placeholder="<%= shop.checkout_note_title %>" style="height: 82px;text-indent: 2.5rem;"><%= order.customer_note %></textarea>\n                    </div>\n                </div>\n            </div>\n            <% } %>\n                \n            \n            <div data-edit-cart="" class="clickable color-grey-medium type-small-caps tar">\n                edit cart\n            </div>\n            <div data-edit-address="" class="clickable color-grey-medium type-small-caps tar">\n                edit address\n            </div>\n            <div data-edit-links-spacer class="no-select">&nbsp;</div>\n\n\n    <% \n            }\n        }\n    %> \n    \n\n'}),define("text!ecommerce/templates/client/paymentOptions.html",[],function(){return'\x3c!------------ \n    Not ready for purchases   \n--------------\x3e\n<% if (canTakePurchases) { %>\n\n\n\n    <% if (order.total == 0) { %>\n        \n        <% if (shop.checkout_terms_conditions) { %>\n         <div class="checkmark color-white">\n             <label class="grid checkmark-agree clickable" for="terms_agreed">\n                 <input type="checkbox" name="terms_agreed" id="terms_agreed" <% if( termsAgreedUponPreviously ) { %> <%= checked=\'checked\' %> <% } %> />\n                 <div class="checkmark-icon col-center">\n                     <svg viewBox="0 0 23 20" style="enable-background:new 0 0 23 20;">\n                         <polygon id="svg-box" points="19,20 0,20 0,1 15.4,1 15.4,2 1,2 1,19 18,19 18,10.3 19,10.3   "/>\n                         <polygon id="svg-check" points="9,14.1 4,9.3 4.7,8.6 9,12.7 22,0.1 22.7,0.8"/>\n                         <path id="svg-box-full" d="M19,20H0V1h19V20z M1,19h17V2H1V19z"/>\n                     </svg>\n                 </div>\n                 <span class="agree-text" style="margin-left: .5rem;">&nbsp;I agree to the&nbsp;</span>\n             </label>\n             <div><a class="terms-conditions type-underline clickable" href="<%= (window.origin + \'/\' + shop.checkout_terms_conditions_pid) %>" target="_blank">Terms &amp; Conditions</a>\n             </div>\n         </div>\n         <% } %>\n\n        <div class="row" data-checkout-zero-wrapper>\n            <div data-checkout-zero class="button-large col bg-blackest color-white tac clickable noselect flex outline pad-x-one-five pad-y-one tac display-block" style="font-size: 17px;">\n                <div data-spinner class="psa"><%= Cargo.Core.Handlebars.Render( \'{{>loading_animation}}\', {extra_class: \'\'} ) %></div>\n                <span class="type-bold">Checkout</span>\n            </div>\n        </div>\n    <% } else { %>\n\n        \n    \x3c!--------------\n        Terms & Conditions\n    -----------------\x3e\n\n             <% if (shop.checkout_terms_conditions) { %>\n             <div class="checkmark color-white">\n                 <label class="grid checkmark-agree clickable" for="terms_agreed">\n                     <input type="checkbox" name="terms_agreed" id="terms_agreed" <% if( termsAgreedUponPreviously ) { %> <%= checked=\'checked\' %> <% } %> />\n                     <div class="checkmark-icon col-center">\n                         <svg viewBox="0 0 23 20" style="enable-background:new 0 0 23 20;">\n                             <polygon id="svg-box" points="19,20 0,20 0,1 15.4,1 15.4,2 1,2 1,19 18,19 18,10.3 19,10.3   "/>\n                             <polygon id="svg-check" points="9,14.1 4,9.3 4.7,8.6 9,12.7 22,0.1 22.7,0.8"/>\n                             <path id="svg-box-full" d="M19,20H0V1h19V20z M1,19h17V2H1V19z"/>\n                         </svg>\n                     </div>\n                     <span class="agree-text" style="margin-left: .5rem;">&nbsp;I agree to the&nbsp;</span>\n                 </label>\n                 <div><a class="terms-conditions type-underline clickable" href="<%= (window.origin + \'/\' + shop.checkout_terms_conditions_pid) %>" target="_blank">Terms &amp; Conditions</a>\n                 </div>\n             </div>\n             <% } %>\n\n    \x3c!--------------\n            error message field \n    -----------------\x3e\n        <div class="col col-full row pad-top-reset hidden type-size-normal" data-message="payment" style=" margin-bottom: 1.5rem;">\n            <div class="col pad-block-small type-size-normal bg-red color-white multi-line">\n                <div class="message-arrow"></div>\n                <div data-error-message>Error</div>\n            </div>  \n        </div>\n\n\n    \x3c!--------------\n           credit card form\n    -----------------\x3e\n        <div data-cc-form style="">\n            <div class="cc-form-wrapper bg-grey-light" style="background: #e3e3e3;">\n                <div toggle-cc-form class="col row flex flex-col bg-white color-black margin-bottom-1">\n                    <div class="grid col svg-text-cardicons pad-small pos-rel clickable">\n                        <div class="no-select">Credit Card</div>\n                        <div>\n                            <div class="pos-abs" style="top:9px;right:9px;">\n                                 <img id="Bitmap-Copy-2" x="0" y="0" width="160" height="22" src="/_jsapps/ecommerce-v2/imgs/cards.png">\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            \n                <div id="checkout-container" class="<% if (shop.has_paypal) { %>closed<% } %>">\n\n                    <form id="payment-form" class="cargo-stripe-form cc-form payment-option margin-bottom-1">\n\n                        <div id="cardnumber-element" class="col stripe-cc-element" style="margin: 1px 0;"></div>\n\n                        <div class="col row col-full group-horizontal flex negative-margin-bottom" id="card-details">\n                            <div id="cardexpiry-element" class="col stripe-cc-element " ></div>\n                            <div id="cardcvc-element" class="col stripe-cc-element " style="margin-left: 1px;"></div>\n                            <div id="cardpostalcode-element" class="col stripe-cc-element " style="margin-left: 1px;"></div>\n                        </div>\n                    </form>\n\n                    <div class="row flex full-width full-width" data-checkout-cc="" style="border-top: 1px solid #8B8B8B;">\n                        <div class="button-large col bg-grey-light color-black clickable noselect flex  pad-x-one-five pad-y-one type-bold display-block " style="height: 4rem; line-height: 1.2; background: #E3E3E3;">\n\n                            <span>Pay&nbsp;<span data-order-total><%= helpers.formatPriceForCurrency(order.total, order.currency) %></span></span>\n                            <div data-spinner class="psa" style="top: 1rem; left: 1rem;"><%= Cargo.Core.Handlebars.Render( \'{{>loading_animation}}\', {extra_class: \'gray-dark no-delay\'} ) %></div>\n                        </div>\n                    </div>\n\n                </div>\n            </div>\n        </div>\n\n\n    \x3c!--------------\n            apple / google pay ( payment request )\n    -----------------\x3e\n        <div data-start-paymentrequest >\n            <% if(window.ApplePaySession && ApplePaySession.canMakePayments()) { %>\n                <div class="" style="padding-top: 1.5rem;">\n                    <div class="apple-pay-button-wrapper clickable">\n                        <div class="apple-pay-button-with-text apple-pay-button-black-with-text" style="-webkit-appearance: -apple-pay-button; height: 38px; width: 100%; display: block; -apple-pay-button-style: white;">\n                            <span class="text">Buy with</span>\n                            <span class="logo"></span>\n                        </div>\n                    </div>\n                </div>\n            <% } %>\n        </div>\n\n\n    \x3c!--------------\n            paypal button\n    -----------------\x3e\n        <div class="" data-paypal-buttons></div>\n\n\n    <% } %>\n\n<% } else { %>\n\n    <div class="col col-full row color-white pad-top-medium">\n        Error: Lorem Ipsum...\n    </div>\n    \n<% } %>\n'}),define("text!ecommerce/templates/client/checkoutSuccess.html",[],function(){return'<div class="overflow-auto position-cover cart-padding">\n\t\x3c!-- close button --\x3e\n\t<div data-close="" class="x flex-end pos-abs clickable">\n\t        <div style="display: contents;">\n\t            <svg width="17px" height="17px" viewBox="0 0 17 17" >\n\t                <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" opacity="0.400000006">\n\t                    <g id="Group" transform="translate(1.000000, 1.000000)" stroke="#FFFFFF" stroke-width="2">\n\t                        <path d="M0,0 L15,15" id="Path-3"></path>\n\t                        <path d="M0,0 L15,15" id="Path-3" transform="translate(7.500000, 7.500000) rotate(-270.000000) translate(-7.500000, -7.500000) "></path>\n\t                    </g>\n\t                </g>\n\t            </svg>\n\t        </div>\n\t    </div>\n\t\n\t<div class="flex flex-col flex-center flex-start" style="min-height: 100%;padding-bottom:8rem;">\n\n\t\t<div class="pad-y-medium pad-top-reset color-white" style="width: 100%;">\n\t\t\t<div class="col multi-line">\n\t\t\t\t<div data-order-success-message class="pen">\n\n\t\t\t\t\t<svg x="0px" y="0px" viewBox="0 0 25 25" style="enable-background:new 0 0 25 25; width: 25px; height: auto; display: inline-block; position: absolute; transform: translate(0, -3px);" >\n\t\t\t\t\t\t<path fill="#698FFF" d="M12.5,0C5.6,0,0,5.6,0,12.5C0,19.4,5.6,25,12.5,25C19.4,25,25,19.4,25,12.5C25,5.6,19.4,0,12.5,0z M10,18.7\n\t\t\t\t\t\tL10,18.7L10,18.7l-5.5-5.5l1.9-1.9l3.5,3.6l8.6-8.6l1.9,1.9L10,18.7z"/>\n\t\t\t\t\t</svg>\n\n\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t<span class="type-size-big" style="letter-spacing: .01em; margin-left: 3.5rem;">Order Completed</span><br><br>\n\t\t\t\t\t\n\t\t\t\t\t<% if (shop.checkout_thank_you_msg_enabled == true) { %>\n\t\t\t\t\t\t<span class="type-size-normal overflow-wrap" style="line-height: 1.4;">\n\t\t\t\t\t\t\t<%= shop.checkout_thank_you_msg.replace(/\\n/g, "<br />") %>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t<% } else { %>\n\t\t\t\t\t<span class="type-size-normal" style="line-height: 1.4;">\n\t\t\t\t\t\tYou will receive a confirmation email with your order number shortly.\n\t\t\t\t\t</span>\n\t\t\t\t\t<% } %>\n\n\t\t\t\t</div>\n\n\t\t\t\t<% _.each(order.items, function(item){ %>\n\n\t\t\t\t\t<% if(item.is_digital && item.digital_message) { %>\n\n\t\t\t\t\t\t<div data-digital-item class="overflow-wrap"><br><%= item.digital_message.replace(/\\n/g, "<br />") %></div>\n\n\t\t\t\t\t<% } %>\n\n\t\t\t\t<% }); %>\n\n\t\t\t</div>\n\t\t</div>\n\n\n\n\t</div>\n</div>\n'}),function(e,t){function a(t){this.element=t,this.$element=e(t),this.init()}var n="textareaAutoSize",i="plugin_"+n;a.prototype={init:function(){var a=(this.$element.outerHeight(),parseInt(this.$element.css("paddingBottom"))+parseInt(this.$element.css("paddingTop"))||0);(function(e){return e.replace(/\s/g,"").length>0})(this.element.value)&&this.$element.height(this.element.scrollHeight-a),this.$element.on("input keyup resize",function(){var n=e(t),i=n.scrollTop();e(this).height(0).height(this.scrollHeight-a),n.scrollTop(i)})}},e.fn[n]=function(t){return this.each(function(){e.data(this,i)||e.data(this,i,new a(this,t))}),this}}(jQuery,window,document),define("global_libs/jquery_plugins/autosize",function(){}),define("ecommerce/views/client/checkout",["text!ecommerce/templates/client/checkout.html","text!ecommerce/templates/client/ordersummary.html","text!ecommerce/templates/client/paymentOptions.html","text!ecommerce/templates/client/checkoutSuccess.html","ecommerce/models/order","ecommerce/models/shop","ecommerce/helpers","global_libs/jquery_plugins/autosize"],function(e,t,a,n,i,r,o){return Backbone.View.extend({template:_.template(e),summary:_.template(t),payment:_.template(a),successTemplate:_.template(n),className:"ecommerce-cart",events:{"click [data-close]":"close","click [data-start-paymentrequest]":"startPaymentRequest","click [data-checkout-cc]":"handleCCPayment","click [data-checkout-ideal]":"handleIDealPayment","click [data-back]":"navigateBack",'click [name="pay-with"]':"handlePaymentTabs","click [toggle-cc-form]":"toggleCCForm","click [data-edit-address]":"navigateToAddressForm","click [data-edit-cart]":"navigateToCart","click [data-checkout-zero]":"confirmFreeOrder",'change input[name="shipping_method"]':"changeShippingMethod","change #terms_agreed":"termsAndConditionAgreementToggled","change [data-order-note]":"updateOrderNote"},initialize:function(e){this.showLoader=e.showLoader,this.hideLoader=e.hideLoader,this.orderLoaded=!1;try{parent&&parent.Cargo&&parent.Cargo.Helper.isSafari()&&this.$el.addClass("safari")}catch(e){}if("previewsuccess"===e.orderId.split("-")[0]){var t=e.orderId.split("-")[1];return t&&Cargo.Ecommerce.Collection.products.each(function(e){e.variantCollection.get(t)&&(this.previewVariant=e.variantCollection.get(t))},this),this.previewSuccessTemplate=!0,this.listenTo(r,"change:checkout_thank_you_msg change:checkout_thank_you_msg_enabled",_.throttle(this.render,250)),void(this.previewVariant&&this.listenTo(this.previewVariant,"change:digital_message",_.throttle(this.render,250)))}var a=document.getElementById("following-overlay");a&&(a.classList.add("prevent-close"),a.style.cursor="",this.listenTo(this,"remove",function(){a.classList.remove("prevent-close"),a.style.cursor="pointer"})),this.order=new i({order_id:e.orderId}),this.previousShippingIdNotAvailable=!1,this.showLoader(),this.order.fetch({success:_.bind(function(){"paid"!==this.order.get("status")?(Cargo.Ecommerce.__restored_shipping_id__&&(Cargo.Ecommerce.__restored_shipping_id__,this.order.get("selected_shipping_id"),delete Cargo.Ecommerce.__restored_shipping_id__),this.orderLoaded=!0,this.render(),this.el.querySelector("[data-order-wrapper]").style.visibility="",this.listenTo(this.order,"change:total",function(e,t){0!==e.get("total")&&0!==e.previous("total")||this.renderPaymentOptions()}),this.showPaymentOptions()):Cargo.Router.navigate("cart",{trigger:!0})},this),error:_.bind(function(e,t,a){Cargo.Router.navigate("cart",{trigger:!0})},this)})},initPaymentOptions:function(){var e=Cargo.Ecommerce.loadStripeAPI().then(this.setupStripe.bind(this)).then(()=>!0).catch(function(e){e&&"not setup"===e.message||console.error(e)}),t=Cargo.Ecommerce.loadPayPalAPI().then(this.setupPayPal.bind(this)).then(()=>!0).catch(function(e){e&&"not setup"===e.message||console.error(e)}.bind(this));Promise.all([e,t]).then(function(e){this.hasStripe=e[0]||!1,this.hasPaypal=e[1]||!1,this.hasStripe?this.setupApplePay().then(_.bind(function(){this.hasApple=!0,this.$el.find("[data-payment-options]").addClass("has_apple"),this.showPaymentOptions()},this)).catch(_.bind(function(e){this.showPaymentOptions()},this)):this.showPaymentOptions()}.bind(this)).catch(function(e){console.error(e)})},updateOrderNote:function(e){this.order&&this.order.save({customer_note:e.target.value.replace(/</g,"&lt;").replace(/>/g,"&gt;")},{patch:!0})},showPaymentOptions:function(){var e=this.$el.find("[data-payment-options]");e.removeClass("hidden"),this.hasPaypal&&e.addClass("has_paypal"),this.hasStripe&&e.addClass("has_stripe"),this.hasApple&&e.addClass("has_stripe has_apple"),r.get("checkout_terms_conditions")&&e.addClass("has_checkbox"),this.hasApple||this.hasStripe||this.hasPaypal?e.removeClass("testing_mode"):e.addClass("testing_mode")},setupStripe:function(){return new Promise((e,t)=>{if(void 0===Cargo.View.Following.contentWindow.Stripe)return t(new Error("Stripe API not available"));r.fetch().always(()=>{this.stripe=Cargo.View.Following.contentWindow.Stripe(r.get("stripe_public_key")),this.stripeElements=this.stripe.elements(),this.el.children.length>0&&this.bindCCFormElements(),e()})})},setupApplePay:function(){return new Promise((e,t)=>{if(!window.ApplePaySession)return t();$.get(Cargo.API.GetBasePath()+"/paymentmethod/setup_apple_pay").always(function(a){try{Cargo.View.Following.contentWindow.Following.View.Main.applePayChecked=!0}catch(e){console.error(e)}this.stripePaymentRequest=this.stripe.paymentRequest({country:"US",currency:this.order.get("currency").toLowerCase(),total:{amount:0,label:"Shopping Cart Total",pending:!0},requestShipping:!1,requestPayerEmail:!0}),this.stripePaymentRequest.on("paymentmethod",function(e){this.setupPaymentIntent({type:"paymentRequest",paymentRequestEvent:e})}.bind(this)),this.stripePaymentRequest.canMakePayment().then(a=>{a.applePay?e():t()}).catch(t)}.bind(this))})},setupPayPal:function(){return new Promise((e,t)=>{var a=this.el.querySelector("[data-paypal-buttons]");return a?void 0===Cargo.View.Following.contentWindow.paypal?t(new Error("PayPal API not available")):(Cargo.View.Following.contentWindow.paypal.Buttons({style:{tagline:!1,color:"white",height:40,shape:"rect",label:"paypal",layout:"horizontal"},onInit:function(e,t){var a=this.el.querySelector("[data-order-note]"),n=this.el.querySelector("#terms_agreed");a&&a.addEventListener("blur",function(e){this.validateOrderNote()&&this.validateTermsAndConditions()?t.enable():t.disable()}.bind(this)),n&&n.addEventListener("change",function(e){this.validateOrderNote()&&this.validateTermsAndConditions()?t.enable():t.disable()}.bind(this)),this.validateOrderNote()&&this.validateTermsAndConditions()||t.disable()}.bind(this),onClick:function(){this.el.querySelector("#terms_agreed"),this.el.querySelector("[data-order-note]");this.validateOrderNote()?this.validateTermsAndConditions()||(Cargo.Modal.Alert({selector:"html",message:"Please agree to<br>the Terms & Conditions"}),Cargo.Modal.$el.find(".confirm-box").css({top:""}),Cargo.Modal.$el.find(".modal-overlay").css({top:""})):(Cargo.Modal.Alert({selector:"html",message:"Please enter a note"}),Cargo.Modal.$el.find(".confirm-box").css({top:""}),Cargo.Modal.$el.find(".modal-overlay").css({top:""}))}.bind(this),createOrder:function(e,t){return t.order.create({purchase_units:[{amount:{value:o.convertFractionalAmountToMainCurrencyUnit(this.order.get("total"),this.order.get("currency"))}}]})}.bind(this),onApprove:function(e,t){this.el.querySelector("[data-order-wrapper]").style.display="none",this.showLoader(),this.order.capturePayPal(e).done(e=>{e.error?this.handlePaymentFailure(e.error.message):this.handlePaymentSuccess(e)}).fail(e=>{var t="There was an issue with the purchase. Please try again.";e&&e.responseJSON&&e.responseJSON.error?t=e.responseJSON.error.message:e&&e.responseJSON&&e.responseJSON.message&&(t=e.responseJSON.message),this.handlePaymentFailure(t),410===e.status&&(Cargo.Ecommerce.Collection.cart.reset(),Cargo.Router.navigate("/cart",{replace:!0,trigger:!0})),this.el.querySelector("[data-order-wrapper]").style.display="",this.hideLoader()})}.bind(this)}).render(a),a.style.display="",void e()):t(new Error("No render target for PayPal"))})},render:function(e){if(this.hideLoader(),this.previewSuccessTemplate){var t=this.previewVariant?this.previewVariant.toJSON():void 0;if(t&&"string"==typeof t.digital_message){t.digital_message=t.digital_message.replace(/(\b(https?|ftp):\/\/([-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]))/gim,function(e){var t=e.split("/").pop().split("?")[0];return t&&0!==t.length||(t=arguments[3]),'<a href="#" onclick="return false;">'+t+"</a>"})}this.el.innerHTML=this.successTemplate({order:{items:t?[t]:[]},shop:r.toJSON()})}else if(this.el.innerHTML=this.template({order:this.order?this.order.toJSON():void 0,shop:r.toJSON(),canTakePurchases:r.canTakePayments()}),!1!==this.orderLoaded)return this.renderPaymentOptions(),this.renderOrderSummary(),this.stripe&&this.bindCCFormElements(),setTimeout(function(){$("textarea",this.el).textareaAutoSize()}.bind(this),250),this},renderOrderSummary:function(){this.el.querySelector("[data-order-summary-container]").innerHTML=this.summary({order:this.order.toJSON(),helpers:o,shop:r.toJSON(),previousShippingIdNotAvailable:this.previousShippingIdNotAvailable}),this.el.querySelectorAll(".shipping-option-text").forEach(function(e){e&&e.offsetWidth>e.parentNode.offsetWidth&&e.setAttribute("title",e.textContent.replace("âœ“","").trim())})},renderPaymentOptions:function(){if(r.canTakePayments()){0!==this.order.get("total")&&this.initPaymentOptions();var e=!1;try{e="true"===localStorage.getItem("order_"+this.order.id+"_terms_agreed")}catch(e){console.error(e)}this.paymentOptionsContainer=this.el.querySelector("[data-payment-options]"),this.paymentOptionsContainer.innerHTML=this.payment({canTakePurchases:r.canTakePayments(),canMakePaymentRequest:this.canMakePaymentRequest,order:this.order.toJSON(),helpers:o,shop:r.toJSON(),termsAgreedUponPreviously:e}),r.get("checkout_terms_conditions")&&Cargo.Collection.Scaffolding.fetchPageModel(r.get("checkout_terms_conditions_pid"),{done:_.bind(function(e){e&&e.get("direct_link")&&this.$el.find("a.terms-conditions").attr("href",e.get("direct_link"))},this),silent:!0,render_changes:!1,insert:!1})}},startPaymentRequest:function(){if(this.stripePaymentRequest){if(!this.validateOrderNote())return Cargo.Modal.Alert({selector:"html",message:"Please enter a note"}),Cargo.Modal.$el.find(".confirm-box").css({top:""}),void Cargo.Modal.$el.find(".modal-overlay").css({top:""});if(!this.validateTermsAndConditions())return Cargo.Modal.Alert({selector:"html",message:"Please agree to<br>the Terms & Conditions"}),Cargo.Modal.$el.find(".confirm-box").css({top:""}),void Cargo.Modal.$el.find(".modal-overlay").css({top:""});this.stripePaymentRequest.update({total:{amount:this.order.get("total"),label:"Shopping Cart Total",pending:!1}}),this.stripePaymentRequest.show()}},bindCCFormElements:function(){var e={style:{base:{color:"#000",lineHeight:"1.5",fontFamily:'-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif',fontSmoothing:"antialiased",fontSize:"15px","::placeholder":{color:"#999"},iconColor:"#fff",":-webkit-autofill":{}},invalid:{color:"#f03",iconColor:"#fff"}},classes:{focus:"focus",empty:"empty",invalid:"invalid"}};this.cardPostalCode&&this.cardPostalCode.destroy(),this.cardNumber&&this.cardNumber.destroy(),this.cardExpiry&&this.cardExpiry.destroy(),this.cardCvc&&this.cardCvc.destroy(),this.cardNumber=this.stripeElements.create("cardNumber",_.extend(e,{placeholder:"Card Number..."})),this.cardNumber.mount("#cardnumber-element"),this.cardExpiry=this.stripeElements.create("cardExpiry",_.extend(e,{placeholder:"MM / YY..."})),this.cardExpiry.mount("#cardexpiry-element"),this.cardCvc=this.stripeElements.create("cardCvc",_.extend(e,{placeholder:"CVC..."})),this.cardCvc.mount("#cardcvc-element"),this.cardPostalCode=this.stripeElements.create("postalCode",_.extend(e,{placeholder:"Zip..."})),this.cardPostalCode.mount("#cardpostalcode-element")},validateOrderNote:function(){return!r.get("checkout_note_enabled")||!r.get("checkout_note_mandatory")||"string"==typeof this.order.get("customer_note")&&0!==this.order.get("customer_note").length},validateTermsAndConditions:function(){var e=this.el.querySelector("#terms_agreed");return null===e||e.checked},handleCCPayment:function(e){if(this.clearErrorFields(),!this.validateOrderNote())return Cargo.Modal.Alert({selector:"html",message:"Please enter a note"}),Cargo.Modal.$el.find(".confirm-box").css({top:""}),void Cargo.Modal.$el.find(".modal-overlay").css({top:""});if(!this.validateTermsAndConditions())return Cargo.Modal.Alert({selector:"html",message:"Please agree to<br>the Terms & Conditions"}),Cargo.Modal.$el.find(".confirm-box").css({top:""}),void Cargo.Modal.$el.find(".modal-overlay").css({top:""});if($(e.currentTarget).find(".button-large").addClass("loading"),null!==this.el.querySelector("[data-customer-info]")){var t=this.el.querySelector('input[name="name"]').value,a=this.el.querySelector('input[name="email"]').value;if(!1===this.validateInput("Name",t)||!1===this.validateInput("Email address",a))return;this.order.save({name:t,email:a},{patch:!0,success:function(){this.setupPaymentIntent({type:"CC",element:this.cardNumber})}.bind(this),error:function(){this.el.querySelector("[data-spinner]").innerHTML="",alert("Something went wrong with submitting your order.")}})}else this.setupPaymentIntent({type:"CC",element:this.cardNumber})},handleIDealPayment:function(e){if(this.clearErrorFields(),!this.validateOrderNote())return Cargo.Modal.Alert({selector:"html",message:"Please enter a note"}),Cargo.Modal.$el.find(".confirm-box").css({top:""}),void Cargo.Modal.$el.find(".modal-overlay").css({top:""});if(!this.validateTermsAndConditions())return Cargo.Modal.Alert({selector:"html",message:"Please agree to<br>the Terms & Conditions"}),Cargo.Modal.$el.find(".confirm-box").css({top:""}),void Cargo.Modal.$el.find(".modal-overlay").css({top:""});if($(e.currentTarget).find(".button-large").addClass("loading"),null!==this.el.querySelector("[data-customer-info]")){var t=this.el.querySelector('input[name="name"]').value,a=this.el.querySelector('input[name="email"]').value;if(!1===this.validateInput("Name",t)||!1===this.validateInput("Email address",a))return;this.order.save({name:t,email:a},{patch:!0,success:function(){this.el.querySelector("[data-spinner]").style.display="",this.setupPaymentIntent({type:"ideal",element:this.cardNumber})}.bind(this),error:function(){this.el.querySelector("[data-spinner]").innerHTML="",alert("Something went wrong with submitting your order.")}})}else this.el.querySelector("[data-spinner]").style.display="",this.setupPaymentIntent({type:"ideal",element:this.cardNumber})},confirmFreeOrder:function(){return this.validateOrderNote()?this.validateTermsAndConditions()?void this.order.confirmFree().then(function(e){this.handlePaymentSuccess(e)}.bind(this)):(Cargo.Modal.Alert({selector:"html",message:"Please agree to<br>the Terms & Conditions"}),Cargo.Modal.$el.find(".confirm-box").css({top:""}),void Cargo.Modal.$el.find(".modal-overlay").css({top:""})):(Cargo.Modal.Alert({selector:"html",message:"Please enter a note"}),Cargo.Modal.$el.find(".confirm-box").css({top:""}),void Cargo.Modal.$el.find(".modal-overlay").css({top:""}))},setupPaymentIntent:function(e){return!(!e||void 0===e.type)&&(!this.processing_payment&&(this.processing_payment=!0,void this.order.getPaymentIntent(e).done(function(t){if("paymentRequest"===e.type&&e.paymentRequestEvent.complete("success"),!t||!t.client_secret)return this.handlePaymentFailure("Unable to authorize card."),void(this.processing_payment=!1);e.intent=t,this.confirmPaymentIntent(e)}.bind(this)).fail(function(t){"paymentRequest"===e.type&&e.paymentRequestEvent.complete("fail");var a="There was an issue with the purchase. Please try again.";t&&t.responseJSON&&t.responseJSON.error?a=t.responseJSON.error.message:t&&t.responseJSON&&t.responseJSON.message&&(a=t.responseJSON.message),this.handlePaymentFailure(a),410===t.status&&(Cargo.Ecommerce.Collection.cart.reset(),Cargo.Router.navigate("/cart",{replace:!0,trigger:!0}))}.bind(this))))},confirmPaymentIntent:function(e){var t;if("paymentRequest"===e.type)t=this.stripe.confirmPaymentIntent(e.intent.client_secret,{payment_method:e.paymentRequestEvent.paymentMethod.id});else if("CC"===e.type){var a=this.order.get("address")||{};t=this.stripe.confirmPaymentIntent(e.intent.client_secret,e.element,{payment_method_data:{billing_details:{address:{city:a.city,country:a.country,line1:a.address1,line2:a.address2,postal_code:a.postal_code,state:a.state},email:this.order.get("email"),name:this.order.get("name"),phone:a.phone}}})}else if("ideal"===e.type)return void this.confirmiDEALPayment(e);t.then(function(t){t.error?this.handlePaymentFailure(t.error.message):(e.intent=t.paymentIntent,"requires_action"!==t.paymentIntent.status?this.capturePaymentIntent(e):this.stripe.handleCardPayment(t.paymentIntent.client_secret).then(function(t){t.error?this.handlePaymentFailure(t.error.message,"validation_error"===t.error.type):this.capturePaymentIntent(e)}.bind(this)))}.bind(this)).catch(function(){this.handlePaymentFailure("There was an issue with the purchase. Please try again.")}.bind(this))},capturePaymentIntent:function(e){this.order.capturePaymentIntent(e.intent.id).done(function(e){e.error?this.handlePaymentFailure(e.error.message):this.handlePaymentSuccess(e)}.bind(this)).fail(function(t){"paymentRequest"===e.type&&e.paymentRequestEvent.complete("fail");var a="There was an issue with the purchase. Please try again.";t&&t.responseJSON&&t.responseJSON.error?a=t.responseJSON.error.message:t&&t.responseJSON&&t.responseJSON.message&&(a=t.responseJSON.message),410===t.status&&(Cargo.Ecommerce.Collection.cart.reset(),Cargo.Router.navigate("/cart",{replace:!0,trigger:!0})),this.handlePaymentFailure(a)}.bind(this))},confirmiDEALPayment:function(e){this.stripe.confirmIdealPayment(e.intent.client_secret,{payment_method:{ideal:{},billing_details:{name:this.order.get("name"),email:this.order.get("email")}},return_url:window.location.origin+"/_jsapps/ecommerce-v2/static/stripe-ideal-callback.html"},{handleActions:!1}).then(function(e){if(e.error)this.handlePaymentFailure(e.error.message);else if(e.paymentIntent&&e.paymentIntent.next_action&&e.paymentIntent.next_action.redirect_to_url){var t=document.createElement("iframe");t.className="ideal-iframe",t.src=e.paymentIntent.next_action.redirect_to_url.url,window.addEventListener("message",function(e){if(e.origin===window.location.origin)if(t.remove(),"ideal-callback"===e.data.type){var a=new URLSearchParams(e.data.queryparams);a.has("payment_intent")&&a.has("payment_intent_client_secret")?this.stripe.retrievePaymentIntent(a.get("payment_intent_client_secret")).then(function(e){e.error?this.handlePaymentFailure(e.error.message):e.paymentIntent&&"succeeded"===e.paymentIntent.status?this.handlePaymentSuccess(this.order.toJSON()):this.handlePaymentFailure("Unable to authenticate iDEAL payment.")}.bind(this)):this.handlePaymentFailure("Unable to authenticate iDEAL payment.")}else this.handlePaymentFailure("Unable to authenticate iDEAL payment.")}.bind(this),{once:!0}),this.el.appendChild(t)}else this.handlePaymentFailure("Unable to authenticate iDEAL payment.")}.bind(this))},handlePaymentTabs:function(e){var t=e.currentTarget.id;$("#payment-form",this.el).hide(),"use-card"==t&&($("#payment-form",this.el).show(),$("#cardnumber-element").focus());e.currentTarget.ownerDocument},handlePaymentFailure:function(e,t){e=e.replace(/\'/,"â€™"),this.processing_payment=!1,t||(Cargo.Modal.Alert({selector:"html",message:e}),Cargo.Modal.$el.find(".confirm-box").css({top:""}),Cargo.Modal.$el.find(".modal-overlay").css({top:""})),$(".loading",this.el).removeClass("loading")},handlePaymentSuccess:function(e){this.processing_payment=!1,Cargo.Ecommerce.Collection.cart.reset(),delete Cargo.View.Following.contentWindow.Following.View.Main.lastCartRoute,Cargo.Ecommerce.Collection.products.fetchMultiple(_.pluck(e.items,"product_id"),{always:function(){!0===r.get("checkout_success_page_enabled")?Cargo.Collection.Scaffolding.fetchPageModel(r.get("checkout_success_page_pid"),{done:_.bind(function(e){Cargo.Router.navigate("/cart",{replace:!0,trigger:!0}),this.hideLoader(),e.get("is_homepage")?(Cargo.View.Content.activeContentModel&&Cargo.View.Content.activeContentModel.get("id")!=Cargo.Helper.GetHomepageId()&&Cargo.View.Content.RenderHomepage(),Cargo.Router.navigate("",{replace:!0,trigger:!1})):Cargo.Router.navigate(e.get("project_url"),{replace:!0,trigger:!0}),Cargo.View.Following.Toggle({preventNavigate:!0})},this),error:()=>{this.hideLoader(),this.el.innerHTML=this.successTemplate({order:e,shop:r.toJSON()})},silent:!0,render_changes:!1,insert:!1}):(this.hideLoader(),this.el.innerHTML=this.successTemplate({order:e,shop:r.toJSON()}))}.bind(this)})},changeShippingMethod:function(e){if(this.order){$('[name="shipping_method"]').each(function(){var e=$(this).next("label").find(".shipping-option-text").html();e=e.replace(/<b>âœ“<\/b>&nbsp;&nbsp;/,""),$(this).next("label").find(".shipping-option-text").html(e)});var t=$(e.currentTarget).next("label").find(".shipping-option-text").html();$(e.currentTarget).next("label").find(".shipping-option-text").html("<b>âœ“</b>&nbsp;&nbsp;"+t);var a=e.currentTarget.getAttribute("value");a!==this.order.selected_shipping_id&&(this.order.save({selected_shipping_id:a},{patch:!0}).always(()=>{this.$el.find("[data-order-total]").text(o.formatPriceForCurrency(this.order.get("total"),this.order.get("currency"))),this.renderOrderSummary()}),this.renderOrderSummary())}},validateInput:function(e,t){return""!=t&&null!=t&&null!=t||(Cargo.Modal.Alert({selector:"html",message:"Please enter a valid "+e+"."}),Cargo.Modal.$el.find(".confirm-box").css({top:""}),Cargo.Modal.$el.find(".modal-overlay").css({top:""}),!1)},termsAndConditionAgreementToggled:function(e){try{var t="order_"+this.order.id+"_terms_agreed";e.currentTarget.checked?localStorage.setItem(t,"true"):localStorage.removeItem(t)}catch(e){console.error(e)}},toggleCCForm:function(e){$("#checkout-container",this.el).toggleClass("closed")},navigateToCart:function(e){Cargo.Router.navigate("cart/"+this.order.id,{trigger:!0})},navigateToAddressForm:function(e){Cargo.Router.navigate("cart/address/"+this.order.id,{trigger:!0})},navigateBack:function(){Cargo.Router.navigate("cart/summary/"+this.order.id,{trigger:!0})},close:function(){Cargo.View.Following.Toggle()},displayErrorMessage:function(e,t){e.removeClass("hidden"),e.find("[data-error-message]").html(t+"<br>")},clearErrorFields:function(){$(".error").removeClass("error"),$("[data-message]").each(function(e){$(this).addClass("hidden"),$(this).find("[data-error-message]").html("")})}})}),require(["ecommerce-client"]);